{"version":3,"file":"js/824.b8781b5b.js","mappings":"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","sources":["webpack://data-processor-frontend/./src/components/CsvFileUploader.vue","webpack://data-processor-frontend/./src/components/CsvFileUploader.vue?6e86","webpack://data-processor-frontend/./src/views/CsvFilesView.vue","webpack://data-processor-frontend/./src/views/CsvFilesView.vue?3e4a"],"sourcesContent":["<template>\n  <div class=\"csv-uploader card\">\n    <div class=\"card-header bg-light\">\n      <h5 class=\"mb-0\">Upload CSV Mapping File</h5>\n    </div>\n    <div class=\"card-body\">\n      <form @submit.prevent=\"uploadFile\">\n        <div class=\"mb-3\">\n          <label for=\"fileTitle\" class=\"form-label\">Title</label>\n          <input \n            type=\"text\" \n            class=\"form-control\" \n            id=\"fileTitle\" \n            v-model=\"title\" \n            placeholder=\"Enter a descriptive title\"\n            required\n          >\n        </div>\n        \n        <div class=\"mb-3\">\n          <label for=\"csvFile\" class=\"form-label\">CSV File</label>\n          <input \n            type=\"file\" \n            class=\"form-control\" \n            id=\"csvFile\" \n            @change=\"handleFileSelection\"\n            accept=\".csv\"\n            required\n          >\n          <div class=\"form-text\">Upload a CSV file with mapping information for crop images.</div>\n        </div>\n        \n        <div class=\"d-grid gap-2\">\n          <button \n            type=\"submit\" \n            class=\"btn btn-success\" \n            :disabled=\"!selectedFile || loading\"\n          >\n            <span v-if=\"loading\" class=\"spinner-border spinner-border-sm me-2\" role=\"status\"></span>\n            Upload CSV File\n          </button>\n        </div>\n      </form>\n      \n      <div v-if=\"uploadSuccess\" class=\"alert alert-success mt-3\">\n        CSV file uploaded successfully! \n        <button @click=\"processFile\" class=\"btn btn-sm btn-outline-success ms-2\" :disabled=\"processing\">\n          <span v-if=\"processing\" class=\"spinner-border spinner-border-sm me-2\" role=\"status\"></span>\n          Process Now\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapActions, mapGetters } from 'vuex';\n\nexport default {\n  name: 'CsvFileUploader',\n  data() {\n    return {\n      title: '',\n      selectedFile: null,\n      uploadSuccess: false,\n      uploadedFileId: null,\n      processing: false,\n    }\n  },\n  computed: {\n    ...mapGetters(['isLoading']),\n    loading() {\n      return this.isLoading;\n    }\n  },\n  methods: {\n    ...mapActions('crop', ['uploadCsvFile', 'processCsvFile']),\n    \n    handleFileSelection(event) {\n      const file = event.target.files[0];\n      if (file) {\n        this.selectedFile = file;\n        // Set default title based on filename if title is empty\n        if (!this.title) {\n          this.title = file.name.replace(/\\.csv$/i, '');\n        }\n      }\n    },\n    \n    async uploadFile() {\n      if (!this.selectedFile) return;\n      \n      try {\n        const formData = new FormData();\n        formData.append('name', this.title); // Changed from 'title' to 'name' to match backend\n        formData.append('file', this.selectedFile);\n        \n        const fileData = await this.uploadCsvFile(formData);\n        \n        this.uploadSuccess = true;\n        this.uploadedFileId = fileData.id;\n        this.$emit('file-uploaded', fileData);\n        \n        // Display success toast\n        this.$toast?.success('CSV file uploaded successfully!');\n        \n        // Reset form for next upload\n        this.resetForm();\n      } catch (error) {\n        console.error('Error uploading file:', error);\n        this.$toast?.error('Failed to upload file. Please try again.');\n      }\n    },\n    \n    async processFile() {\n      if (!this.uploadedFileId) return;\n      \n      this.processing = true;\n      try {\n        const result = await this.processCsvFile(this.uploadedFileId);\n        this.$toast?.success(`CSV file processed successfully! ${result.created} records created.`);\n        this.$emit('file-processed', { id: this.uploadedFileId, result });\n      } catch (error) {\n        console.error('Error processing file:', error);\n        this.$toast?.error('Failed to process file. Please try again.');\n      } finally {\n        this.processing = false;\n        this.uploadSuccess = false;\n        this.uploadedFileId = null;\n      }\n    },\n    \n    resetForm() {\n      this.title = '';\n      this.selectedFile = null;\n      this.uploadSuccess = false;\n      // Reset the file input by clearing its value\n      const fileInput = document.getElementById('csvFile');\n      if (fileInput) fileInput.value = '';\n      \n      // Wait one tick to ensure DOM updates\n      this.$nextTick(() => {\n        // Force re-render of the file input\n        const container = document.querySelector('.csv-uploader');\n        if (container) container.style.opacity = '0.99';\n        setTimeout(() => {\n          if (container) container.style.opacity = '1';\n        }, 10);\n      });\n    }\n  }\n}\n</script>\n\n<style scoped>\n.csv-uploader {\n  border-radius: 8px;\n  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);\n  transition: box-shadow 0.3s ease;\n}\n\n.csv-uploader:hover {\n  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);\n}\n\n.card-header {\n  border-bottom: 1px solid rgba(0, 0, 0, 0.05);\n}\n</style>\n","import { render } from \"./CsvFileUploader.vue?vue&type=template&id=34355260&scoped=true\"\nimport script from \"./CsvFileUploader.vue?vue&type=script&lang=js\"\nexport * from \"./CsvFileUploader.vue?vue&type=script&lang=js\"\n\nimport \"./CsvFileUploader.vue?vue&type=style&index=0&id=34355260&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-34355260\"]])\n\nexport default __exports__","<template>\n  <div class=\"csv-files-view\">\n    <div class=\"mb-4\">\n      <router-link to=\"/\" class=\"btn btn-sm btn-outline-secondary\">\n        <i class=\"bi bi-arrow-left me-1\"></i> Back\n      </router-link>\n      <h2 class=\"mt-3\">CSV File Management</h2>\n    </div>\n    \n    <div class=\"row mb-4\">\n      <div class=\"col-md-6\">\n        <base-card title=\"Upload CSV Mapping File\">\n          <csv-file-uploader @file-uploaded=\"handleFileUploaded\" @file-processed=\"handleFileProcessed\" />\n        </base-card>\n      </div>\n      \n      <div class=\"col-md-6\">\n        <base-card title=\"CSV File Guidelines\">\n          <div class=\"guidelines\">\n            <h5>Creating Effective CSV Mapping Files</h5>\n            <p>Your CSV file should include these key columns:</p>\n            <ul>\n              <li><strong>sample_id</strong> - Unique identifier for each crop sample</li>\n              <li><strong>description</strong> (optional) - Description of the crop image</li>\n            </ul>\n            <p>Additional columns will be treated as metadata for the crop images.</p>\n            <p>Example format:</p>\n            <div class=\"csv-example p-2 rounded bg-light\">\n              <code>sample_id,description,crop_type,plant_age,health_status</code><br>\n              <code>CROP_001,Young tomato plant,Tomato,14 days,Healthy</code><br>\n              <code>CROP_002,Mature lettuce,Lettuce,45 days,Pest damage</code>\n            </div>\n          </div>\n        </base-card>\n      </div>\n    </div>\n    \n    <base-card>\n      <template #header>\n        <div class=\"d-flex justify-content-between align-items-center\">\n          <h5 class=\"mb-0\">CSV Files</h5>\n          <div>\n            <base-button \n              size=\"sm\" \n              variant=\"outline-primary\" \n              @click=\"refreshFiles\" \n              :loading=\"loading\"\n            >\n              <i class=\"bi bi-arrow-clockwise me-1\"></i> Refresh\n            </base-button>\n          </div>\n        </div>\n      </template>\n      \n      <div v-if=\"loading\" class=\"text-center py-5\">\n        <div class=\"spinner-border text-primary\" role=\"status\">\n          <span class=\"visually-hidden\">Loading...</span>\n        </div>\n        <p class=\"mt-2 text-muted\">Loading CSV files...</p>\n      </div>\n      \n      <div v-else-if=\"csvFiles.length === 0\" class=\"text-center py-5 bg-light rounded\">\n        <div class=\"display-1 text-muted mb-3\">\n          <i class=\"bi bi-file-earmark-spreadsheet\"></i>\n        </div>\n        <h4 class=\"text-muted\">No CSV Files Found</h4>\n        <p class=\"text-muted\">Upload CSV mapping files to get started.</p>\n      </div>\n      \n      <div v-else>\n        <div class=\"table-responsive\">\n          <table class=\"table table-hover\">\n            <thead class=\"table-light\">\n              <tr>\n                <th>File Name</th>\n                <th>Uploaded</th>\n                <th>Images</th>\n                <th>Actions</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr v-for=\"file in csvFiles\" :key=\"file.id\">\n                <td>{{ file.name }}</td>\n                <td>{{ formatDate(file.uploaded_at) }}</td>\n                <td>\n                  <span class=\"badge bg-info rounded-pill\">{{ file.crop_images_count || 0 }}</span>\n                </td>\n                <td>\n                  <div class=\"btn-group btn-group-sm\">\n                    <base-button \n                      variant=\"outline-primary\" \n                      @click=\"viewRelatedImages(file.id)\"\n                    >\n                      View Images\n                    </base-button>\n                    <base-button \n                      variant=\"outline-success\" \n                      @click=\"processFile(file.id)\"\n                      :disabled=\"processing === file.id\"\n                    >\n                      <span v-if=\"processing === file.id\" class=\"spinner-border spinner-border-sm me-1\" role=\"status\"></span>\n                      Process\n                    </base-button>\n                  </div>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </base-card>\n  </div>\n</template>\n\n<script>\nimport { mapActions, mapGetters } from 'vuex';\nimport BaseCard from '@/components/common/BaseCard.vue';\nimport BaseButton from '@/components/common/BaseButton.vue';\nimport CsvFileUploader from '@/components/CsvFileUploader.vue';\n\nexport default {\n  name: 'CsvFilesView',\n  components: {\n    BaseCard,\n    BaseButton,\n    CsvFileUploader\n  },\n  data() {\n    return {\n      processing: null\n    };\n  },\n  computed: {\n    ...mapGetters('crop', ['getCsvFiles', 'isLoading']),\n    csvFiles() {\n      return this.getCsvFiles || [];\n    },\n    loading() {\n      return this.isLoading;\n    }\n  },\n  mounted() {\n    this.fetchCsvFiles();\n  },\n  methods: {\n    ...mapActions('crop', ['fetchCsvFiles', 'processCsvFile']),\n    \n    refreshFiles() {\n      this.fetchCsvFiles();\n    },\n    \n    handleFileUploaded(file) {\n      this.$toast?.success(`File \"${file.title}\" uploaded successfully!`);\n      this.refreshFiles();\n    },\n    \n    handleFileProcessed(result) {\n      this.$toast?.success(`File processed successfully! ${result.created} records created.`);\n      this.refreshFiles();\n    },\n    \n    async processFile(fileId) {\n      this.processing = fileId;\n      \n      try {\n        const result = await this.processCsvFile(fileId);\n        this.$toast?.success(`CSV file processed: ${result.created} created, ${result.updated} updated`);\n        this.refreshFiles();\n      } catch (error) {\n        console.error('Error processing file:', error);\n        this.$toast?.error('Failed to process file. Please try again.');\n      } finally {\n        this.processing = null;\n      }\n    },\n    \n    viewRelatedImages(fileId) {\n      // Navigate to the crop images view with a filter for this CSV file\n      this.$router.push({ \n        name: 'crop-images', \n        query: { csv_file: fileId } \n      });\n    },\n    \n    formatDate(dateString) {\n      if (!dateString) return 'Unknown';\n      const date = new Date(dateString);\n      return date.toLocaleDateString() + ' ' + date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n    }\n  }\n};\n</script>\n\n<style scoped>\n.csv-files-view {\n  margin-bottom: 2rem;\n}\n\n.guidelines {\n  font-size: 0.95rem;\n}\n\n.csv-example {\n  font-size: 0.85rem;\n  overflow-x: auto;\n  white-space: nowrap;\n  margin-top: 10px;\n}\n</style>\n","import { render } from \"./CsvFilesView.vue?vue&type=template&id=7845f92e&scoped=true\"\nimport script from \"./CsvFilesView.vue?vue&type=script&lang=js\"\nexport * from \"./CsvFilesView.vue?vue&type=script&lang=js\"\n\nimport \"./CsvFilesView.vue?vue&type=style&index=0&id=7845f92e&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-7845f92e\"]])\n\nexport default __exports__"],"names":["class","key","role","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","onSubmit","_cache","_withModifiers","args","$options","uploadFile","_hoisted_3","for","type","id","$event","$data","title","placeholder","required","_hoisted_4","onChange","handleFileSelection","accept","_hoisted_5","disabled","selectedFile","loading","_hoisted_7","_createCommentVNode","_createTextVNode","_hoisted_6","uploadSuccess","_hoisted_8","onClick","processFile","processing","_hoisted_10","_hoisted_9","name","data","uploadedFileId","computed","mapGetters","this","isLoading","methods","mapActions","event","file","target","files","replace","formData","FormData","append","fileData","uploadCsvFile","$emit","$toast","success","resetForm","error","console","result","processCsvFile","created","fileInput","document","getElementById","value","$nextTick","container","querySelector","style","opacity","setTimeout","__exports__","render","_createVNode","_component_router_link","to","default","_withCtx","_","_component_base_card","_component_csv_file_uploader","onFileUploaded","handleFileUploaded","onFileProcessed","handleFileProcessed","header","_component_base_button","size","variant","refreshFiles","csvFiles","length","_hoisted_11","_Fragment","_renderList","_toDisplayString","formatDate","uploaded_at","_hoisted_12","crop_images_count","_hoisted_13","viewRelatedImages","_hoisted_14","components","BaseCard","BaseButton","CsvFileUploader","getCsvFiles","mounted","fetchCsvFiles","fileId","updated","$router","push","query","csv_file","dateString","date","Date","toLocaleDateString","toLocaleTimeString","hour","minute"],"sourceRoot":""}