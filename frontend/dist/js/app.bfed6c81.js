(()=>{"use strict";var e={228:(e,t,a)=>{a.d(t,{A:()=>m});var s=a(641),r=a(33);const o={class:"base-card"},i={key:0,class:"card-header"},l={class:"mb-0"},n={class:"card-body"},c={key:1,class:"card-footer"};function d(e,t,a,d,u,h){return(0,s.uX)(),(0,s.CE)("div",o,[a.title||e.$slots.header?((0,s.uX)(),(0,s.CE)("div",i,[(0,s.RG)(e.$slots,"header",{},(()=>[(0,s.Lk)("h5",l,(0,r.v_)(a.title),1)]),!0)])):(0,s.Q3)("",!0),(0,s.Lk)("div",n,[(0,s.RG)(e.$slots,"default",{},void 0,!0)]),e.$slots.footer?((0,s.uX)(),(0,s.CE)("div",c,[(0,s.RG)(e.$slots,"footer",{},void 0,!0)])):(0,s.Q3)("",!0)])}const u={name:"BaseCard",props:{title:{type:String,default:""}}};var h=a(262);const p=(0,h.A)(u,[["render",d],["__scopeId","data-v-88af9a88"]]),m=p},566:(e,t,a)=>{var s=a(751),r=a(641),o=a(33);const i={id:"app"},l={key:0,class:"navbar navbar-expand-lg navbar-dark bg-success mb-4"},n={class:"container"},c={class:"collapse navbar-collapse",id:"navbarNav"},d={class:"navbar-nav me-auto"},u={class:"nav-item"},h={class:"nav-item"},p={class:"nav-item"},m={class:"d-flex"},g={class:"container mt-4"},f={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"};function b(e,t,a,s,b,v){const k=(0,r.g2)("router-link"),y=(0,r.g2)("router-view");return(0,r.uX)(),(0,r.CE)("div",i,[e.isAuthenticated?((0,r.uX)(),(0,r.CE)("nav",l,[(0,r.Lk)("div",n,[(0,r.bF)(k,{class:"navbar-brand",to:"/"},{default:(0,r.k6)((()=>t[2]||(t[2]=[(0,r.Lk)("span",{class:"brand-name"},[(0,r.eW)("Aqua"),(0,r.Lk)("span",{class:"text-light"},"Green")],-1)]))),_:1}),t[6]||(t[6]=(0,r.Lk)("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav"},[(0,r.Lk)("span",{class:"navbar-toggler-icon"})],-1)),(0,r.Lk)("div",c,[(0,r.Lk)("ul",d,[(0,r.Lk)("li",u,[(0,r.bF)(k,{class:"nav-link",to:"/dashboard"},{default:(0,r.k6)((()=>t[3]||(t[3]=[(0,r.eW)("Home")]))),_:1})]),(0,r.Lk)("li",h,[(0,r.bF)(k,{class:"nav-link",to:"/upload"},{default:(0,r.k6)((()=>t[4]||(t[4]=[(0,r.eW)("Upload")]))),_:1})]),(0,r.Lk)("li",p,[(0,r.bF)(k,{class:"nav-link",to:"/files"},{default:(0,r.k6)((()=>t[5]||(t[5]=[(0,r.eW)("Files")]))),_:1})])]),(0,r.Lk)("div",m,[(0,r.bF)(k,{to:"/profile",class:"navbar-text me-3 text-light text-decoration-none"},{default:(0,r.k6)((()=>[(0,r.eW)(" Welcome, "+(0,o.v_)(e.currentUser?e.currentUser.username:"User"),1)])),_:1}),(0,r.Lk)("button",{onClick:t[0]||(t[0]=(...t)=>e.handleLogout&&e.handleLogout(...t)),class:"btn btn-outline-light btn-sm"}," Logout ")])])])])):(0,r.Q3)("",!0),(0,r.Lk)("div",g,[e.error?((0,r.uX)(),(0,r.CE)("div",f,[(0,r.eW)((0,o.v_)(e.error)+" ",1),(0,r.Lk)("button",{type:"button",class:"btn-close",onClick:t[1]||(t[1]=(...t)=>e.clearError&&e.clearError(...t))})])):(0,r.Q3)("",!0),(0,r.bF)(y)]),t[7]||(t[7]=(0,r.Lk)("footer",{class:"footer mt-5 py-3 bg-light"},[(0,r.Lk)("div",{class:"container text-center"},[(0,r.Lk)("span",{class:"text-muted"},"AquaGreen Â© 2025")])],-1))])}var v=a(278);const k="lastActivityTime",y=18e5;function C(e){L();const t=["mousedown","keypress","scroll","touchstart"];t.forEach((e=>{window.addEventListener(e,L)}));const a=setInterval((()=>{w(e)}),6e4);return()=>{t.forEach((e=>{window.removeEventListener(e,L)})),clearInterval(a)}}function L(){localStorage.setItem(k,Date.now().toString())}function w(e){const t=localStorage.getItem(k);if(!t)return void L();const a=Date.now(),s=parseInt(t,10),r=a-s;r>y&&(localStorage.removeItem(k),e())}const F=(0,r.pM)({name:"App",data(){return{sessionTimeoutCleanup:null}},computed:{...(0,v.aH)(["error"]),isAuthenticated(){return this.$store.state.isAuthenticated},currentUser(){return this.$store.state.user}},watch:{isAuthenticated(e){e?this.initializeSessionTimeout():this.cleanupSessionTimeout()}},mounted(){this.isAuthenticated&&this.initializeSessionTimeout()},beforeUnmount(){this.cleanupSessionTimeout()},methods:{...(0,v.i0)(["logout"]),clearError(){this.$store.commit("setError",null)},async handleLogout(){await this.logout(),this.$toast?.success("You have been successfully logged out"),this.$router.push("/login")},initializeSessionTimeout(){this.cleanupSessionTimeout(),this.sessionTimeoutCleanup=C((async()=>{await this.logout(),this.$router.push("/login"),this.$toast?.warning("Your session has expired due to inactivity.")}))},cleanupSessionTimeout(){this.sessionTimeoutCleanup&&(this.sessionTimeoutCleanup(),this.sessionTimeoutCleanup=null)}}});var _=a(262);const E=(0,_.A)(F,[["render",b]]),A=E;var x=a(220);const D={class:"home"},$={class:"jumbotron bg-light p-5 rounded mb-4"},I={class:"row mt-5"},T={class:"col-md-6 mb-4"},S={class:"card h-100 border-success"},P={class:"card-body"},W={class:"d-flex flex-wrap gap-2"},X={class:"col-md-6 mb-4"},U={class:"card h-100 border-success"},B={class:"card-body"},O={class:"d-flex flex-wrap gap-2"};function j(e,t,a,s,o,i){const l=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)("div",D,[(0,r.Lk)("div",$,[t[1]||(t[1]=(0,r.Lk)("h1",{class:"display-4 text-success"},"Welcome to AquaGreen",-1)),t[2]||(t[2]=(0,r.Lk)("hr",{class:"my-4"},null,-1)),t[3]||(t[3]=(0,r.Lk)("p",null,"Upload your Excel files, process data, and visualize greenhouse metrics in one place.",-1)),(0,r.bF)(l,{to:"/upload",class:"btn btn-success btn-lg"},{default:(0,r.k6)((()=>t[0]||(t[0]=[(0,r.eW)("Upload Excel File")]))),_:1})]),(0,r.Lk)("div",I,[(0,r.Lk)("div",T,[(0,r.Lk)("div",S,[t[8]||(t[8]=(0,r.Lk)("div",{class:"card-header bg-success text-white"},[(0,r.Lk)("h5",{class:"card-title mb-0"},"Plant Growth Analysis")],-1)),(0,r.Lk)("div",P,[t[6]||(t[6]=(0,r.Lk)("p",{class:"card-text"},"Upload, view, and analyze greenhouse data and metrics.",-1)),t[7]||(t[7]=(0,r.Lk)("ul",{class:"mb-3"},[(0,r.Lk)("li",null,"Track growth rates over time"),(0,r.Lk)("li",null,"Compare different plant varieties"),(0,r.Lk)("li",null,"Identify optimal growing conditions"),(0,r.Lk)("li",null,"Upload and manage Excel files")],-1)),(0,r.Lk)("div",W,[(0,r.bF)(l,{to:"/upload",class:"btn btn-outline-success"},{default:(0,r.k6)((()=>t[4]||(t[4]=[(0,r.eW)("Upload Files")]))),_:1}),(0,r.bF)(l,{to:"/files",class:"btn btn-outline-success"},{default:(0,r.k6)((()=>t[5]||(t[5]=[(0,r.eW)("View Files")]))),_:1})])])])]),(0,r.Lk)("div",X,[(0,r.Lk)("div",U,[t[13]||(t[13]=(0,r.Lk)("div",{class:"card-header bg-success text-white"},[(0,r.Lk)("h5",{class:"card-title mb-0"},"Genetic Mapping Images")],-1)),(0,r.Lk)("div",B,[t[11]||(t[11]=(0,r.Lk)("p",{class:"card-text"},"Manage crop images and CSV files for genetic analysis.",-1)),t[12]||(t[12]=(0,r.Lk)("ul",{class:"mb-3"},[(0,r.Lk)("li",null,"Upload and manage crop images with metadata"),(0,r.Lk)("li",null,"Process CSV mapping files for crop data"),(0,r.Lk)("li",null,"View gene expression heat maps"),(0,r.Lk)("li",null,"Analyze genetic markers"),(0,r.Lk)("li",null,"Compare genetic variations")],-1)),(0,r.Lk)("div",O,[(0,r.bF)(l,{to:"/crop-images",class:"btn btn-outline-success"},{default:(0,r.k6)((()=>t[9]||(t[9]=[(0,r.eW)("Manage Crop Images")]))),_:1}),(0,r.bF)(l,{to:"/csv-files",class:"btn btn-outline-success"},{default:(0,r.k6)((()=>t[10]||(t[10]=[(0,r.eW)("Manage CSV Files")]))),_:1})])])])])])])}const z=(0,r.pM)({name:"HomeView",data(){return{}}}),M=(0,_.A)(z,[["render",j],["__scopeId","data-v-9e7e4e36"]]),N=M,V={class:"upload-view"},q={class:"mb-4"},G={class:"mb-3"},H={class:"mb-3"},R={key:0,class:"alert alert-danger"},Q={key:1,class:"alert alert-danger"},J={key:2,class:"alert alert-danger"},K={class:"d-flex gap-2 mb-3"},Z={key:3},Y={class:"table table-bordered"},ee={class:"alert alert-success"};function te(e,t,a,i,l,n){const c=(0,r.g2)("router-link"),d=(0,r.g2)("BaseButton"),u=(0,r.g2)("BaseCard");return(0,r.uX)(),(0,r.CE)("div",V,[(0,r.Lk)("div",q,[(0,r.bF)(c,{to:"/",class:"btn btn-sm btn-outline-secondary"},{default:(0,r.k6)((()=>t[3]||(t[3]=[(0,r.Lk)("i",{class:"bi bi-arrow-left me-1"},null,-1),(0,r.eW)(" Back ")]))),_:1}),t[4]||(t[4]=(0,r.Lk)("h2",{class:"mt-3 text-success"},"Upload Greenhouse Data",-1))]),(0,r.bF)(u,{class:"mb-4"},{header:(0,r.k6)((()=>t[5]||(t[5]=[(0,r.Lk)("h5",{class:"card-title mb-0"},"Upload Excel File",-1)]))),default:(0,r.k6)((()=>[(0,r.Lk)("form",{onSubmit:t[2]||(t[2]=(0,s.D$)(((...e)=>n.uploadFile&&n.uploadFile(...e)),["prevent"]))},[(0,r.Lk)("div",G,[t[6]||(t[6]=(0,r.Lk)("label",{for:"title",class:"form-label"},"Title",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":t[0]||(t[0]=e=>l.title=e),placeholder:"Enter a descriptive title for your data",required:""},null,512),[[s.Jo,l.title]]),t[7]||(t[7]=(0,r.Lk)("div",{class:"form-text"},"Give your file a meaningful name related to your greenhouse data.",-1))]),(0,r.Lk)("div",H,[t[8]||(t[8]=(0,r.Lk)("label",{for:"file",class:"form-label"},"Excel File",-1)),(0,r.Lk)("input",{type:"file",class:"form-control",id:"file",onChange:t[1]||(t[1]=(...e)=>n.handleFileChange&&n.handleFileChange(...e)),accept:".xlsx,.xls",required:""},null,32),t[9]||(t[9]=(0,r.Lk)("div",{class:"form-text"},"Accepted formats: .xlsx, .xls (Excel files only)",-1))]),l.fileError?((0,r.uX)(),(0,r.CE)("div",R,[t[10]||(t[10]=(0,r.Lk)("i",{class:"bi bi-exclamation-triangle-fill me-2"},null,-1)),(0,r.eW)(" "+(0,o.v_)(l.fileError),1)])):(0,r.Q3)("",!0),l.previewError?((0,r.uX)(),(0,r.CE)("div",Q,[t[11]||(t[11]=(0,r.Lk)("i",{class:"bi bi-exclamation-triangle-fill me-2"},null,-1)),(0,r.eW)(" "+(0,o.v_)(l.previewError),1)])):(0,r.Q3)("",!0),e.error?((0,r.uX)(),(0,r.CE)("div",J,[t[12]||(t[12]=(0,r.Lk)("i",{class:"bi bi-exclamation-triangle-fill me-2"},null,-1)),(0,r.eW)(" "+(0,o.v_)("object"===typeof e.error?Object.values(e.error).flat().join(", "):e.error),1)])):(0,r.Q3)("",!0),(0,r.Lk)("div",K,[(0,r.bF)(d,{variant:"info",disabled:!l.file||l.previewLoading,loading:l.previewLoading,onClick:n.previewFile},{default:(0,r.k6)((()=>t[13]||(t[13]=[(0,r.eW)(" Preview Data ")]))),_:1},8,["disabled","loading","onClick"]),(0,r.bF)(d,{variant:"success",disabled:e.loading||!l.file||!l.previewData.length,loading:e.loading,type:"submit"},{default:(0,r.k6)((()=>t[14]||(t[14]=[(0,r.eW)(" Confirm Upload ")]))),_:1},8,["disabled","loading"])]),l.previewData.length?((0,r.uX)(),(0,r.CE)("div",Z,[t[15]||(t[15]=(0,r.Lk)("h5",null,"Data Preview (first 5 rows)",-1)),(0,r.Lk)("table",Y,[(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(Object.keys(l.previewData[0]),(e=>((0,r.uX)(),(0,r.CE)("th",{key:e},(0,o.v_)(e),1)))),128))])]),(0,r.Lk)("tbody",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.previewData,((e,t)=>((0,r.uX)(),(0,r.CE)("tr",{key:t},[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(Object.keys(e),(t=>((0,r.uX)(),(0,r.CE)("td",{key:t},(0,o.v_)(e[t]),1)))),128))])))),128))])])])):(0,r.Q3)("",!0)],32)])),_:1}),(0,r.bF)(u,null,{header:(0,r.k6)((()=>t[16]||(t[16]=[(0,r.Lk)("h5",{class:"card-title mb-0"},"Upload Guidelines",-1)]))),default:(0,r.k6)((()=>[t[21]||(t[21]=(0,r.Lk)("h6",{class:"card-subtitle mb-3 text-success"},"How to prepare your greenhouse data files:",-1)),t[22]||(t[22]=(0,r.Lk)("ul",{class:"list-group list-group-flush mb-3"},[(0,r.Lk)("li",{class:"list-group-item bg-light"},[(0,r.Lk)("i",{class:"bi bi-check-circle-fill text-success me-2"}),(0,r.eW)(" Ensure your Excel file contains greenhouse data in a structured format ")]),(0,r.Lk)("li",{class:"list-group-item bg-light"},[(0,r.Lk)("i",{class:"bi bi-check-circle-fill text-success me-2"}),(0,r.eW)(" Include headers in your Excel file for better data identification ")]),(0,r.Lk)("li",{class:"list-group-item"},[(0,r.Lk)("i",{class:"bi bi-check-circle-fill text-success me-2"}),(0,r.eW)(" Maximum file size: 10MB ")])],-1)),(0,r.Lk)("div",ee,[t[18]||(t[18]=(0,r.Lk)("i",{class:"bi bi-info-circle-fill me-2"},null,-1)),t[19]||(t[19]=(0,r.eW)(" After uploading, you can view and analyze your data in the ")),(0,r.bF)(c,{to:"/files",class:"alert-link"},{default:(0,r.k6)((()=>t[17]||(t[17]=[(0,r.eW)("Files section")]))),_:1}),t[20]||(t[20]=(0,r.eW)(". "))])])),_:1})])}var ae=a(959),se=a(753),re=a(228);const oe={name:"UploadView",components:{BaseButton:se.A,BaseCard:re.A},data(){return{title:"",file:null,fileError:null,previewData:[],previewLoading:!1,previewError:null,isUploading:!1,uploadProgress:0}},computed:{...(0,v.aH)(["loading","error"])},methods:{...(0,v.i0)(["uploadFile"]),handleFileChange(e){const t=e.target.files[0];if(this.fileError=null,!t)return void(this.file=null);const a=["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"];if(!a.includes(t.type))return this.fileError="Invalid file type. Please upload an Excel file (.xlsx or .xls)",void(this.file=null);const s=10485760;if(t.size>s)return this.fileError="File is too large. Maximum size is 10MB",void(this.file=null);this.file=t},async previewFile(){this.previewError=null,this.previewLoading=!0;try{this.previewData=await this.parseExcel(this.file)}catch(e){this.previewError="Failed to parse file"}finally{this.previewLoading=!1}},parseExcel(e){return new Promise(((t,a)=>{const s=new FileReader;s.onload=e=>{const a=new Uint8Array(e.target.result),s=ae.LF(a,{type:"array"}),r=s.SheetNames[0],o=s.Sheets[r],i=ae.Wp.sheet_to_json(o,{header:1}),l=i[0]||[],n=i.slice(1,6),c=n.map((e=>{const t={};return l.forEach(((a,s)=>{t[a]=e[s]})),t}));t(c)},s.onerror=e=>a(e),s.readAsArrayBuffer(e)}))},async uploadFile(){if(this.file)if(0!==this.file.size){this.isUploading=!0,this.uploadProgress=0;try{const e=new FormData;e.append("title",this.title),e.append("file",this.file);const t=await this.$store.dispatch("uploadFile",e);this.$toast?.success("File uploaded successfully"),t&&t.id?this.$router.push(`/files/${t.id}`):this.$router.push("/files")}catch(e){if(console.error("Upload error:",e.response?.data||e),e.response?.data?.error)this.$toast?.error(`Error: ${e.response.data.error}`);else if(e.response?.data?.detail)this.$toast?.error(`Error: ${e.response.data.detail}`);else if(e.response?.data)if("object"===typeof e.response.data){const t=Object.entries(e.response.data).map((([e,t])=>`${e}: ${t}`)).join(", ");this.$toast?.error(`Validation errors: ${t}`)}else this.$toast?.error(`Error: ${e.response.data}`);else this.$toast?.error("Failed to upload file. Please try again.")}finally{this.isUploading=!1}}else this.$toast?.error("File is empty. Please select a valid file.");else this.$toast?.error("Please select a file to upload")}}},ie=(0,_.A)(oe,[["render",te],["__scopeId","data-v-4b1c371d"]]),le=ie,ne={class:"files-view"},ce={class:"mb-4"},de={key:0,class:"text-center my-5"},ue={key:1,class:"alert alert-danger"},he={key:2,class:"alert alert-info"},pe={class:"mb-0"},me={key:3},ge={class:"mb-3"},fe={class:"input-group"},be={class:"table-responsive"},ve={class:"table table-hover"},ke={class:"btn-group"},ye=["onClick","disabled"],Ce={key:0,class:"spinner-border spinner-border-sm me-1"},Le=["onClick"],we={class:"mt-4 text-center"};function Fe(e,t,a,i,l,n){const c=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)("div",ne,[(0,r.Lk)("div",ce,[(0,r.bF)(c,{to:"/",class:"btn btn-sm btn-outline-secondary"},{default:(0,r.k6)((()=>t[1]||(t[1]=[(0,r.Lk)("i",{class:"bi bi-arrow-left me-1"},null,-1),(0,r.eW)(" Back ")]))),_:1}),t[2]||(t[2]=(0,r.Lk)("h2",{class:"mt-3"},"Greenhouse Data Files",-1))]),e.loading?((0,r.uX)(),(0,r.CE)("div",de,t[3]||(t[3]=[(0,r.Lk)("div",{class:"spinner-border text-success",role:"status"},[(0,r.Lk)("span",{class:"visually-hidden"},"Loading...")],-1),(0,r.Lk)("p",{class:"mt-2"},"Loading files...",-1)]))):e.error?((0,r.uX)(),(0,r.CE)("div",ue,(0,o.v_)(e.error),1)):0===e.files.length?((0,r.uX)(),(0,r.CE)("div",he,[(0,r.Lk)("p",pe,[t[5]||(t[5]=(0,r.eW)("No files uploaded yet. ")),(0,r.bF)(c,{to:"/upload",class:"alert-link"},{default:(0,r.k6)((()=>t[4]||(t[4]=[(0,r.eW)("Upload your first file")]))),_:1}),t[6]||(t[6]=(0,r.eW)("."))])])):((0,r.uX)(),(0,r.CE)("div",me,[(0,r.Lk)("div",ge,[(0,r.Lk)("div",fe,[t[7]||(t[7]=(0,r.Lk)("span",{class:"input-group-text bg-success text-white"},[(0,r.Lk)("i",{class:"bi bi-search"})],-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",class:"form-control border-success",placeholder:"Search files...","onUpdate:modelValue":t[0]||(t[0]=e=>l.searchTerm=e)},null,512),[[s.Jo,l.searchTerm]])])]),(0,r.Lk)("div",be,[(0,r.Lk)("table",ve,[t[11]||(t[11]=(0,r.Lk)("thead",{class:"bg-success text-white"},[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"Title"),(0,r.Lk)("th",null,"Upload Date"),(0,r.Lk)("th",null,"Status"),(0,r.Lk)("th",null,"Actions")])],-1)),(0,r.Lk)("tbody",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(n.filteredFiles,(e=>((0,r.uX)(),(0,r.CE)("tr",{key:e.id},[(0,r.Lk)("td",null,(0,o.v_)(e.title),1),(0,r.Lk)("td",null,(0,o.v_)(n.formatDate(e.uploaded_at)),1),(0,r.Lk)("td",null,[(0,r.Lk)("span",{class:(0,o.C4)(["badge",e.processed?"bg-success":"bg-warning text-dark"])},(0,o.v_)(e.processed?"Processed":"Pending"),3)]),(0,r.Lk)("td",null,[(0,r.Lk)("div",ke,[(0,r.bF)(c,{to:{name:"file-detail",params:{id:e.id}},class:"btn btn-sm btn-outline-success"},{default:(0,r.k6)((()=>t[8]||(t[8]=[(0,r.eW)(" View Details ")]))),_:2},1032,["to"]),e.processed?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("button",{key:0,class:"btn btn-sm btn-success",onClick:t=>n.processFile(e.id),disabled:l.processingFile===e.id},[l.processingFile===e.id?((0,r.uX)(),(0,r.CE)("span",Ce)):(0,r.Q3)("",!0),t[9]||(t[9]=(0,r.eW)(" Process "))],8,ye)),(0,r.Lk)("button",{class:"btn btn-sm btn-outline-danger",onClick:t=>n.confirmDeleteFile(e)},t[10]||(t[10]=[(0,r.Lk)("i",{class:"bi bi-trash"},null,-1)]),8,Le)])])])))),128))])])]),(0,r.Lk)("div",we,[(0,r.bF)(c,{to:"/upload",class:"btn btn-success"},{default:(0,r.k6)((()=>t[12]||(t[12]=[(0,r.Lk)("i",{class:"bi bi-upload me-1"},null,-1),(0,r.eW)(" Upload New File ")]))),_:1})])]))])}const _e={name:"FilesView",data(){return{searchTerm:"",processingFile:null}},computed:{...(0,v.aH)(["files","loading","error"]),filteredFiles(){if(!this.searchTerm)return this.files;const e=this.searchTerm.toLowerCase();return this.files.filter((t=>t.title.toLowerCase().includes(e)))}},created(){this.loadFiles()},methods:{...(0,v.i0)(["fetchFiles","processFile","deleteFile"]),async loadFiles(){try{console.log("Fetching files...");const e=await this.$store.dispatch("fetchFiles");console.log("Files fetched:",e),e&&0===e.length&&console.log("No files returned from API")}catch(e){console.error("Error fetching files:",e),this.$toast.error("Failed to load files")}},async processFile(e){this.processingFile=e;try{await this.$store.dispatch("processFile",e),await this.fetchFiles(),this.$toast.success("File processed successfully")}catch(t){const e=t.response?.data?.error||t.response?.data?.detail||t.message||"Failed to process file";e.includes("is not a zip file")?this.$toast.error("The file format is not supported. Please ensure you are uploading a valid Excel file.",{timeout:6e3}):this.$toast.error(`Processing error: ${e}`,{timeout:5e3}),console.error("Error processing file:",t)}finally{this.processingFile=null}},async confirmDeleteFile(e){if(confirm(`Are you sure you want to delete ${e.title}?`))try{await this.$store.dispatch("deleteFile",e.id),await this.fetchFiles(),this.$toast.success("File deleted successfully")}catch(t){this.$toast.error("Failed to delete file"),console.error("Error deleting file:",t)}},formatDate(e){if(!e)return"";const t=new Date(e);return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(t)}}},Ee=(0,_.A)(_e,[["render",Fe],["__scopeId","data-v-63dfdbc1"]]),Ae=Ee,xe={class:"file-detail"},De={key:0,class:"text-center my-5"},$e={key:1,class:"alert alert-danger"},Ie={key:2,class:"alert alert-warning"},Te={key:3},Se={class:"mb-4"},Pe={class:"mt-3"},We={class:"card mb-4"},Xe={class:"card-header bg-light d-flex justify-content-between align-items-center"},Ue={class:"card-body"},Be={class:"row"},Oe={class:"col-md-6"},je={class:"list-group"},ze={class:"list-group-item"},Me={class:"list-group-item"},Ne={class:"list-group-item"},Ve={class:"col-md-6"},qe={class:"list-group"},Ge={class:"list-group-item"},He={class:"list-group-item"},Re={class:"list-group-item"},Qe={key:0,class:"d-grid gap-2"},Je=["disabled"],Ke={key:0,class:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true"},Ze={key:1},Ye={key:0,class:"alert alert-info mb-4"},et={key:1,class:"card mb-4"},tt={class:"card-body"},at={class:"row mb-4"},st={class:"col-md-3 mb-3"},rt={class:"card bg-success text-white h-100"},ot={class:"card-body"},it={class:"col-md-3 mb-3"},lt={class:"card bg-info text-white h-100"},nt={class:"card-body"},ct={class:"col-md-3 mb-3"},dt={class:"card bg-warning text-dark h-100"},ut={class:"card-body"},ht={class:"col-md-3 mb-3"},pt={class:"card bg-primary text-white h-100"},mt={class:"card-body"},gt={class:"row"},ft={class:"col-md-12 mb-4"},bt={ref:"barChart"},vt={class:"card"},kt={class:"card-header bg-light d-flex justify-content-between align-items-center"},yt={class:"btn-group",role:"group"},Ct={class:"card-body"},Lt={key:0,class:"alert alert-warning"},wt={key:1,class:"alert alert-info"},Ft={key:2},_t={class:"mt-4"},Et={class:"row"},At={class:"col-md-6 mb-4"},xt={class:"col-md-6 mb-4"},Dt={class:"col-md-6 mb-4"},$t={class:"col-md-6 mb-4"},It={class:"col-md-6 mb-4"},Tt={class:"col-md-6 mb-4"};function St(e,t,a,s,i,l){const n=(0,r.g2)("router-link"),c=(0,r.g2)("excel-viewer"),d=(0,r.g2)("chart-container");return(0,r.uX)(),(0,r.CE)("div",xe,[e.loading?((0,r.uX)(),(0,r.CE)("div",De,t[3]||(t[3]=[(0,r.Lk)("div",{class:"spinner-border text-primary",role:"status"},[(0,r.Lk)("span",{class:"visually-hidden"},"Loading...")],-1),(0,r.Lk)("p",{class:"mt-2"},"Loading data...",-1)]))):e.error?((0,r.uX)(),(0,r.CE)("div",$e,(0,o.v_)(e.error),1)):e.currentFile?((0,r.uX)(),(0,r.CE)("div",Te,[(0,r.Lk)("div",Se,[(0,r.bF)(n,{to:"/files",class:"btn btn-sm btn-outline-secondary"},{default:(0,r.k6)((()=>t[7]||(t[7]=[(0,r.Lk)("i",{class:"bi bi-arrow-left me-1"},null,-1),(0,r.eW)(" Back to Files ")]))),_:1}),(0,r.Lk)("h1",Pe,(0,o.v_)(e.currentFile.title),1)]),(0,r.Lk)("div",We,[(0,r.Lk)("div",Xe,[t[9]||(t[9]=(0,r.Lk)("h5",{class:"card-title mb-0"},"File Information",-1)),(0,r.Lk)("div",null,[(0,r.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>l.confirmDeleteFile&&l.confirmDeleteFile(...e)),class:"btn btn-sm btn-outline-danger ms-2"},t[8]||(t[8]=[(0,r.Lk)("i",{class:"bi bi-trash"},null,-1),(0,r.eW)(" Delete ")]))]),(0,r.Lk)("span",{class:(0,o.C4)(e.currentFile.processed?"badge bg-success":"badge bg-warning text-dark")},(0,o.v_)(e.currentFile.processed?"Processed":"Pending"),3)]),(0,r.Lk)("div",Ue,[(0,r.Lk)("div",Be,[(0,r.Lk)("div",Oe,[(0,r.Lk)("ul",je,[(0,r.Lk)("li",ze,[t[10]||(t[10]=(0,r.Lk)("strong",null,"File Name:",-1)),(0,r.eW)(" "+(0,o.v_)(e.currentFile.title),1)]),(0,r.Lk)("li",Me,[t[11]||(t[11]=(0,r.Lk)("strong",null,"Upload Date:",-1)),(0,r.eW)(" "+(0,o.v_)(l.formatDate(e.currentFile.uploaded_at)),1)]),(0,r.Lk)("li",Ne,[t[12]||(t[12]=(0,r.Lk)("strong",null,"Uploaded By:",-1)),(0,r.eW)(" "+(0,o.v_)(e.currentFile.uploaded_by?.username||"Unknown"),1)])])]),(0,r.Lk)("div",Ve,[(0,r.Lk)("ul",qe,[(0,r.Lk)("li",Ge,[t[13]||(t[13]=(0,r.Lk)("strong",null,"File Size:",-1)),(0,r.eW)(" "+(0,o.v_)(l.formatFileSize(e.currentFile.file_size_in_bytes)),1)]),(0,r.Lk)("li",He,[t[14]||(t[14]=(0,r.Lk)("strong",null,"File Type:",-1)),(0,r.eW)(" "+(0,o.v_)(l.getFileExtension(e.currentFile.file)),1)]),(0,r.Lk)("li",Re,[e.currentFile.processed?((0,r.uX)(),(0,r.CE)("div",Ze,t[15]||(t[15]=[(0,r.Lk)("span",{class:"text-success"},[(0,r.Lk)("i",{class:"bi bi-check-circle me-1"}),(0,r.eW)(" Processed successfully")],-1)]))):((0,r.uX)(),(0,r.CE)("div",Qe,[(0,r.Lk)("button",{class:"btn btn-success",onClick:t[1]||(t[1]=t=>l.processFile(e.currentFile.id)),disabled:i.processingFile},[i.processingFile?((0,r.uX)(),(0,r.CE)("span",Ke)):(0,r.Q3)("",!0),(0,r.eW)(" "+(0,o.v_)(i.processingFile?"Processing...":"Process File"),1)],8,Je)]))])])])])])]),i.showProcessingMessage&&!e.currentFile.processed?((0,r.uX)(),(0,r.CE)("div",Ye,t[16]||(t[16]=[(0,r.Lk)("div",{class:"d-flex align-items-center"},[(0,r.Lk)("div",{class:"spinner-border spinner-border-sm text-info me-2",role:"status"}),(0,r.Lk)("div",null,[(0,r.Lk)("strong",null,"Work in progress:"),(0,r.eW)(" Processing your file. This may take a moment... ")])],-1)]))):(0,r.Q3)("",!0),e.currentFile.processed?((0,r.uX)(),(0,r.CE)("div",et,[t[21]||(t[21]=(0,r.Lk)("div",{class:"card-header bg-light"},[(0,r.Lk)("h5",{class:"card-title mb-0"},"Data Analysis")],-1)),(0,r.Lk)("div",tt,[(0,r.Lk)("div",at,[(0,r.Lk)("div",st,[(0,r.Lk)("div",rt,[(0,r.Lk)("div",ot,[t[17]||(t[17]=(0,r.Lk)("h5",{class:"card-title"},"Rows",-1)),(0,r.Lk)("h3",null,(0,o.v_)(e.processedData?.length||0),1)])])]),(0,r.Lk)("div",it,[(0,r.Lk)("div",lt,[(0,r.Lk)("div",nt,[t[18]||(t[18]=(0,r.Lk)("h5",{class:"card-title"},"Columns",-1)),(0,r.Lk)("h3",null,(0,o.v_)(e.processedData&&e.processedData[0]?Object.keys(e.processedData[0]).length:0),1)])])]),(0,r.Lk)("div",ct,[(0,r.Lk)("div",dt,[(0,r.Lk)("div",ut,[t[19]||(t[19]=(0,r.Lk)("h5",{class:"card-title"},"File Size",-1)),(0,r.Lk)("h3",null,(0,o.v_)(l.formatFileSize(e.currentFile.file_size_in_bytes)),1)])])]),(0,r.Lk)("div",ht,[(0,r.Lk)("div",pt,[(0,r.Lk)("div",mt,[t[20]||(t[20]=(0,r.Lk)("h5",{class:"card-title"},"Processed",-1)),(0,r.Lk)("h3",null,(0,o.v_)(l.formatDate(e.currentFile.processed_at)||"Yes"),1)])])])]),(0,r.Lk)("div",gt,[(0,r.Lk)("div",ft,[(0,r.Lk)("canvas",bt,null,512)])])])])):(0,r.Q3)("",!0),(0,r.Lk)("div",vt,[(0,r.Lk)("div",kt,[t[23]||(t[23]=(0,r.Lk)("h5",{class:"card-title mb-0"},"Processed Data",-1)),(0,r.Lk)("div",yt,[(0,r.Lk)("button",{class:"btn btn-sm btn-outline-primary",onClick:t[2]||(t[2]=(...e)=>l.refreshData&&l.refreshData(...e))},t[22]||(t[22]=[(0,r.Lk)("i",{class:"bi bi-arrow-clockwise me-1"},null,-1),(0,r.eW)(" Refresh ")]))])]),(0,r.Lk)("div",Ct,[e.currentFile.processed||e.processedData?e.processedData&&0!==e.processedData.length?((0,r.uX)(),(0,r.CE)("div",Ft,[(0,r.bF)(c,{data:e.processedData,onExportCsv:l.exportCSV},null,8,["data","onExportCsv"]),(0,r.Lk)("div",_t,[t[26]||(t[26]=(0,r.Lk)("h5",{class:"mb-3"},"Data Visualization",-1)),(0,r.Lk)("div",Et,[(0,r.Lk)("div",At,[l.cropGrowthData.datasets.length>0?((0,r.uX)(),(0,r.Wv)(d,{key:0,title:"Crop Growth Metrics","chart-data":l.cropGrowthData,options:i.barChartOptions,description:"Comparison of Height and Width by Crop","initial-chart-type":"bar",showControls:!0},null,8,["chart-data","options"])):(0,r.Q3)("",!0)]),(0,r.Lk)("div",xt,[l.healthIndicatorsData.datasets.length>0?((0,r.uX)(),(0,r.Wv)(d,{key:0,title:"Health Indicators","chart-data":l.healthIndicatorsData,options:i.lineChartOptions,description:"NDVI and Health Score over time","initial-chart-type":"line",showControls:!0},null,8,["chart-data","options"])):(0,r.Q3)("",!0)]),(0,r.Lk)("div",Dt,[l.cropDistributionData.labels.length>0?((0,r.uX)(),(0,r.Wv)(d,{key:0,title:"Crop Distribution","chart-data":l.cropDistributionData,options:i.pieChartOptions,description:"Distribution of crops in dataset","initial-chart-type":"pie",showControls:!0},null,8,["chart-data","options"])):(0,r.Q3)("",!0)]),(0,r.Lk)("div",$t,[l.growthStageData.labels.length>0?((0,r.uX)(),(0,r.Wv)(d,{key:0,title:"Growth Stage Distribution","chart-data":l.growthStageData,options:i.pieChartOptions,description:"Distribution of plant growth stages","initial-chart-type":"pie",showControls:!0},null,8,["chart-data","options"])):(0,r.Q3)("",!0)]),(0,r.Lk)("div",It,[l.healthCategoriesData.labels.length>0?((0,r.uX)(),(0,r.Wv)(d,{key:0,title:"Health Score Categories","chart-data":l.healthCategoriesData,options:i.pieChartOptions,description:"Distribution of plants by health score","initial-chart-type":"pie",showControls:!0},null,8,["chart-data","options"])):(0,r.Q3)("",!0)]),(0,r.Lk)("div",Tt,[l.leafHealthData.datasets.length>0?((0,r.uX)(),(0,r.Wv)(d,{key:0,title:"Leaf Count vs Health Score","chart-data":l.leafHealthData,options:i.scatterChartOptions,description:"Correlation between leaf count and health score","initial-chart-type":"scatter",showControls:!0},null,8,["chart-data","options"])):(0,r.Q3)("",!0)])])])])):((0,r.uX)(),(0,r.CE)("div",wt,t[25]||(t[25]=[(0,r.Lk)("i",{class:"bi bi-info-circle-fill me-2"},null,-1),(0,r.eW)(" No processed data available for this file. ")]))):((0,r.uX)(),(0,r.CE)("div",Lt,t[24]||(t[24]=[(0,r.Lk)("i",{class:"bi bi-exclamation-triangle-fill me-2"},null,-1),(0,r.eW)(' This file has not been processed yet. Click "Process File" above to extract the data. ')])))])])])):((0,r.uX)(),(0,r.CE)("div",Ie,[t[5]||(t[5]=(0,r.eW)(" File not found. ")),(0,r.bF)(n,{to:"/files"},{default:(0,r.k6)((()=>t[4]||(t[4]=[(0,r.eW)("Return to files list")]))),_:1}),t[6]||(t[6]=(0,r.eW)(". "))]))])}const Pt={class:"chart-section"},Wt={class:"chart-header d-flex justify-content-between align-items-center mb-3"},Xt={key:0,class:"btn-group"},Ut=["onClick"],Bt={class:"chart-wrapper"},Ot={key:0,class:"chart-description text-muted small mt-2"};function jt(e,t,a,s,i,l){const n=(0,r.g2)("line-chart"),c=(0,r.g2)("bar-chart"),d=(0,r.g2)("pie-chart");return(0,r.uX)(),(0,r.CE)("div",Pt,[(0,r.Lk)("div",Wt,[(0,r.Lk)("h5",null,(0,o.v_)(a.title),1),a.showControls?((0,r.uX)(),(0,r.CE)("div",Xt,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(i.availableChartTypes,(e=>((0,r.uX)(),(0,r.CE)("button",{key:e.value,class:(0,o.C4)(["btn btn-sm",i.chartType===e.value?"btn-success":"btn-outline-success"]),onClick:t=>l.setChartType(e.value)},[(0,r.Lk)("i",{class:(0,o.C4)([e.icon,"me-1"])},null,2),(0,r.eW)(" "+(0,o.v_)(e.label),1)],10,Ut)))),128))])):(0,r.Q3)("",!0)]),(0,r.Lk)("div",Bt,["line"===i.chartType?((0,r.uX)(),(0,r.Wv)(n,{key:0,"chart-data":a.chartData,options:l.chartOptions},null,8,["chart-data","options"])):"bar"===i.chartType?((0,r.uX)(),(0,r.Wv)(c,{key:1,"chart-data":a.chartData,options:l.chartOptions},null,8,["chart-data","options"])):"pie"===i.chartType?((0,r.uX)(),(0,r.Wv)(d,{key:2,"chart-data":a.chartData,options:l.chartOptions},null,8,["chart-data","options"])):(0,r.Q3)("",!0)]),a.description?((0,r.uX)(),(0,r.CE)("div",Ot,(0,o.v_)(a.description),1)):(0,r.Q3)("",!0)])}const zt={class:"chart-container"},Mt={ref:"chart"};function Nt(e,t,a,s,o,i){return(0,r.uX)(),(0,r.CE)("div",zt,[(0,r.Lk)("canvas",Mt,null,512)])}var Vt=a(468);Vt.Chart.register(...Vt.registerables);const qt={name:"LineChart",props:{chartData:{type:Object,required:!0},options:{type:Object,default:()=>({})}},data(){return{chart:null}},mounted(){this.renderChart()},methods:{renderChart(){const e=this.$refs.chart.getContext("2d");this.chart&&this.chart.destroy(),this.chart=new Vt.Chart(e,{type:"line",data:this.chartData,options:{responsive:!0,maintainAspectRatio:!1,...this.options}})}},watch:{chartData:{deep:!0,handler(){this.renderChart()}}},beforeDestroy(){this.chart&&this.chart.destroy()}},Gt=(0,_.A)(qt,[["render",Nt],["__scopeId","data-v-9d0a4b28"]]),Ht=Gt,Rt={class:"chart-container"},Qt={ref:"chart"};function Jt(e,t,a,s,o,i){return(0,r.uX)(),(0,r.CE)("div",Rt,[(0,r.Lk)("canvas",Qt,null,512)])}Vt.Chart.register(...Vt.registerables);const Kt={name:"BarChart",props:{chartData:{type:Object,required:!0},options:{type:Object,default:()=>({})}},data(){return{chart:null}},mounted(){this.renderChart()},methods:{renderChart(){const e=this.$refs.chart.getContext("2d");this.chart&&this.chart.destroy(),this.chart=new Vt.Chart(e,{type:"bar",data:this.chartData,options:{responsive:!0,maintainAspectRatio:!1,...this.options}})}},watch:{chartData:{deep:!0,handler(){this.renderChart()}}},beforeDestroy(){this.chart&&this.chart.destroy()}},Zt=(0,_.A)(Kt,[["render",Jt],["__scopeId","data-v-5796443e"]]),Yt=Zt,ea={class:"chart-container"},ta={ref:"chart"};function aa(e,t,a,s,o,i){return(0,r.uX)(),(0,r.CE)("div",ea,[(0,r.Lk)("canvas",ta,null,512)])}Vt.Chart.register(...Vt.registerables);const sa={name:"PieChart",props:{chartData:{type:Object,required:!0},options:{type:Object,default:()=>({})}},data(){return{chart:null}},mounted(){this.renderChart()},methods:{renderChart(){const e=this.$refs.chart.getContext("2d");this.chart&&this.chart.destroy(),this.chart=new Vt.Chart(e,{type:"pie",data:this.chartData,options:{responsive:!0,maintainAspectRatio:!1,...this.options}})}},watch:{chartData:{deep:!0,handler(){this.renderChart()}}},beforeDestroy(){this.chart&&this.chart.destroy()}},ra=(0,_.A)(sa,[["render",aa],["__scopeId","data-v-684fa930"]]),oa=ra,ia={name:"ChartContainer",components:{LineChart:Ht,BarChart:Yt,PieChart:oa},props:{title:{type:String,required:!0},chartData:{type:Object,required:!0},options:{type:Object,default:()=>({})},description:{type:String,default:""},initialChartType:{type:String,default:"line"},showControls:{type:Boolean,default:!0}},data(){return{chartType:this.initialChartType,availableChartTypes:[{value:"line",label:"Line",icon:"bi bi-graph-up"},{value:"bar",label:"Bar",icon:"bi bi-bar-chart"},{value:"pie",label:"Pie",icon:"bi bi-pie-chart"}]}},computed:{chartOptions(){return{plugins:{legend:{position:"top"},tooltip:{mode:"index",intersect:!1}},...this.options}}},methods:{setChartType(e){this.chartType=e}}},la=(0,_.A)(ia,[["render",jt],["__scopeId","data-v-ee3068c0"]]),na=la,ca={class:"excel-viewer"},da={class:"excel-toolbar mb-2 d-flex justify-content-between align-items-center"},ua={class:"btn-group"},ha={class:"table-type-selector"},pa={key:0,class:"alert alert-info"},ma={key:1,class:"excel-container"},ga={class:"excel-header"},fa={class:"excel-column-names"},ba=["title"],va={class:"excel-body"},ka={class:"excel-row-header"};function ya(e,t,a,i,l,n){return(0,r.uX)(),(0,r.CE)("div",ca,[(0,r.Lk)("div",da,[(0,r.Lk)("div",ua,[(0,r.Lk)("button",{class:"btn btn-sm btn-outline-secondary",onClick:t[0]||(t[0]=(...e)=>n.downloadExcel&&n.downloadExcel(...e))},t[3]||(t[3]=[(0,r.Lk)("i",{class:"bi bi-file-earmark-excel me-1"},null,-1),(0,r.eW)(" Download Excel ")])),(0,r.Lk)("button",{class:"btn btn-sm btn-outline-success",onClick:t[1]||(t[1]=t=>e.$emit("export-csv"))},t[4]||(t[4]=[(0,r.Lk)("i",{class:"bi bi-download me-1"},null,-1),(0,r.eW)(" Export CSV ")]))]),(0,r.Lk)("div",ha,[t[6]||(t[6]=(0,r.Lk)("span",{class:"me-2"},"Data Type:",-1)),(0,r.bo)((0,r.Lk)("select",{class:"form-select form-select-sm","onUpdate:modelValue":t[2]||(t[2]=e=>l.detectedTableType=e),style:{width:"auto",display:"inline-block"}},t[5]||(t[5]=[(0,r.Lk)("option",{value:"environmental"},"Environmental Data",-1),(0,r.Lk)("option",{value:"production"},"Production Data",-1),(0,r.Lk)("option",{value:"averages"},"Environmental Averages",-1),(0,r.Lk)("option",{value:"generic"},"Generic Data",-1)]),512),[[s.u1,l.detectedTableType]])])]),a.data&&0!==a.data.length?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("div",pa," No data available to display. ")),a.data&&a.data.length>0?((0,r.uX)(),(0,r.CE)("div",ma,[(0,r.Lk)("div",ga,[t[7]||(t[7]=(0,r.Lk)("div",{class:"excel-corner-cell"},null,-1)),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.columnLetters.slice(0,n.sortedColumns.length),((e,t)=>((0,r.uX)(),(0,r.CE)("div",{key:"col-"+t,class:"excel-header-cell"},(0,o.v_)(e),1)))),128))]),(0,r.Lk)("div",fa,[t[8]||(t[8]=(0,r.Lk)("div",{class:"excel-row-header"},"#",-1)),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(n.sortedColumns,((e,t)=>((0,r.uX)(),(0,r.CE)("div",{key:"colname-"+t,class:"excel-column-name",title:e},(0,o.v_)(n.formatColumnName(e)),9,ba)))),128))]),(0,r.Lk)("div",va,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(a.data,((e,t)=>((0,r.uX)(),(0,r.CE)("div",{class:(0,o.C4)(["excel-row",{"excel-row-even":t%2===0}]),key:"row-"+t},[(0,r.Lk)("div",ka,(0,o.v_)(t+1),1),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(n.sortedColumns,((a,s)=>((0,r.uX)(),(0,r.CE)("div",{key:"cell-"+t+"-"+s,class:(0,o.C4)(["excel-cell",{"numeric-cell":"number"===typeof e[a],"date-cell":a.toLowerCase().includes("date")||"time"===a.toLowerCase(),"soil-ph-cell":"soil_ph"===a.toLowerCase(),"soil-moisture-cell":"soil_moisture"===a.toLowerCase(),"soil-temp-cell":"soil_temp"===a.toLowerCase(),"soil-ec-cell":"soil_ec"===a.toLowerCase(),"temperature-cell":a.toLowerCase().includes("temperature"),"humidity-cell":a.toLowerCase().includes("humidity"),"rain-cell":"rain"===a.toLowerCase(),"soil-moisture-env-cell":a.toLowerCase().includes("soil_moisture_"),"yield-cell":"total_yield"===a.toLowerCase(),"financial-cell":["income","expense","net_income"].includes(a.toLowerCase()),"identifier-cell":"nethouse_code"===a.toLowerCase()||"crop_type"===a.toLowerCase(),"average-temp-cell":a.toLowerCase().includes("avg")&&a.toLowerCase().includes("temp"),"average-humidity-cell":a.toLowerCase().includes("avg")&&a.toLowerCase().includes("humidity"),"total-rainfall-cell":"total_rainfall"===a.toLowerCase(),"average-moisture-cell":a.toLowerCase().includes("soil_moisture_")}])},(0,o.v_)(n.formatCellValue(e[a],a)),3)))),128))],2)))),128))])])):(0,r.Q3)("",!0)])}const Ca={name:"ExcelViewer",props:{data:{type:Array,required:!0}},data(){return{columnLetters:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",detectedTableType:"generic"}},computed:{columns(){return this.data&&0!==this.data.length?this.data.reduce(((e,t)=>(Object.keys(t).forEach((t=>{e.includes(t)||e.push(t)})),e)),[]):[]},rows(){return this.data&&0!==this.data.length?[null,...this.data]:[]},tableType(){if(!this.data||0===this.data.length)return"generic";const e=this.columns.map((e=>e.toLowerCase()));return e.includes("time")&&(e.includes("temperature_2m")||e.includes("soil_temperature_0cm"))?"environmental":e.includes("nethouse_code")&&(e.includes("crop_type")||e.includes("total_yield"))?"production":e.includes("growing_period")&&(e.includes("avg_air_temp_2m")||e.includes("avg_soil_temp_0cm"))?"averages":e.includes("record_no")&&(e.includes("soil_ph")||e.includes("soil_ec"))?"fix_column":"generic"},sortedColumns(){const e=this.detectedTableType||this.tableType,t={environmental:["time","temperature_2m","relative_humidity_2m","rain","weather_code","soil_temperature_0cm","soil_temperature_6cm","soil_temperature_18cm","soil_temperature_54cm","soil_moisture_0_to_1cm","soil_moisture_1_to_3cm","soil_moisture_3_to_9cm","soil_moisture_9_to_27cm","soil_moisture_27_to_81cm"],production:["nethouse_code","crop_type","germination_date","transplantation_date","harvest_date","total_yield","income","expense","net_income","number_of_plant"],averages:["nethouse_code","growing_period","avg_air_temp_2m","avg_relative_humidity","total_rainfall","avg_soil_temp_0cm","avg_soil_temp_6cm","avg_soil_temp_18cm","avg_soil_temp_54cm","soil_moisture_0to1cm","soil_moisture_1to3cm","soil_moisture_3to9cm","soil_moisture_9to27cm","soil_moisture_27to81cm"],fix_column:["record_no","date","death_plants","soil_moisture","soil_ph","soil_temp","soil_ec"],generic:["id","name","code","date","time","timestamp","temperature","humidity","moisture"]},a=t[e]||t.generic;return[...this.columns].sort(((e,t)=>{const s=a.findIndex((t=>e.toLowerCase()===t.toLowerCase()||e.toLowerCase().includes(t.toLowerCase()))),r=a.findIndex((e=>t.toLowerCase()===e.toLowerCase()||t.toLowerCase().includes(e.toLowerCase())));return-1!==s&&-1!==r?s-r:-1!==s?-1:-1!==r?1:e.localeCompare(t)}))},formattedData(){if(!this.data||0===this.data.length)return[];const e=this.columns,t=[e.map((e=>this.formatColumnName(e)))];return this.data.forEach((a=>{const s=e.map((e=>void 0!==a[e]?a[e]:""));t.push(s)})),t}},methods:{formatCellValue(e,t){if(void 0===e||null===e)return"";const a=this.detectedTableType||this.tableType,s=t?t.toLowerCase():"";if("string"===typeof e&&e.match(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/)||"date"===s||"time"===s||s.includes("_date"))return new Date(e).toLocaleDateString();if("number"===typeof e){if("environmental"===a){if(s.includes("temperature"))return e.toFixed(1)+" Â°C";if(s.includes("humidity"))return Math.round(e)+" %";if("rain"===s)return e.toFixed(1)+" mm";if(s.includes("moisture"))return e.toFixed(3)+" mÂ³/mÂ³"}else if("production"===a){if("total_yield"===s)return Math.round(e)+" kg";if("income"===s||"expense"===s||"net_income"===s)return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e);if("number_of_plant"===s)return Math.round(e)}else if("averages"===a){if(s.includes("temp"))return e.toFixed(1)+" Â°C";if(s.includes("humidity"))return e.toFixed(1)+" %";if(s.includes("rainfall"))return e.toFixed(1)+" mm";if(s.includes("moisture"))return e.toFixed(3)+" mÂ³/mÂ³"}else if("fix_column"===a){if("soil_ph"===s)return e.toFixed(2);if("soil_ec"===s)return e.toFixed(3);if("soil_moisture"===s||"soil_temp"===s)return e.toFixed(1)}return Number.isInteger(e)||e.toString().split(".")[1]?.length<=2?e:e.toFixed(2)}return e},formatColumnName(e){return e?e.replace(/_/g," ").replace(/([A-Z])/g," $1").replace(/^./,(e=>e.toUpperCase())).trim():""},downloadExcel(){if(this.data&&0!==this.data.length)try{const e=ae.Wp.book_new(),t=ae.Wp.aoa_to_sheet(this.formattedData);ae.Wp.book_append_sheet(e,t,"Data"),ae._h(e,"agricultural_data.xlsx")}catch(e){console.error("Error exporting Excel:",e),this.$toast?.error("Failed to export Excel file")}else this.$toast?.error("No data to export")}}},La=(0,_.A)(Ca,[["render",ya],["__scopeId","data-v-58e55718"]]),wa=La,Fa={name:"FileDetailView",components:{ChartContainer:na,ExcelViewer:wa},data(){return{processingFile:!1,showProcessingMessage:!1,barChartOptions:{scales:{y:{beginAtZero:!0,title:{display:!0,text:"Value"}}},plugins:{legend:{position:"top"}}},lineChartOptions:{scales:{y:{beginAtZero:!0,title:{display:!0,text:"NDVI"},position:"left"},y1:{beginAtZero:!0,title:{display:!0,text:"Health Score"},position:"right",grid:{drawOnChartArea:!1}},y2:{beginAtZero:!0,title:{display:!0,text:"Chlorophyll Index"},position:"right",grid:{drawOnChartArea:!1}}}},scatterChartOptions:{scales:{x:{title:{display:!0,text:"Leaf Count"}},y:{beginAtZero:!0,title:{display:!0,text:"Health Score"}}},plugins:{tooltip:{callbacks:{label:function(e){return`Leaf Count: ${e.parsed.x}, Health Score: ${e.parsed.y}`}}}}},pieChartOptions:{plugins:{legend:{position:"right"}}},financialSummary:{income:12500,expenses:7800,categories:{income:{"Crop Sales":9500,"Equipment Rental":2e3,Subsidies:1e3},expenses:{Seeds:1200,Fertilizer:2500,Labor:3e3,Equipment:1100}}},barChartInstance:null,pieChartInstance:null,pollingInterval:null}},computed:{...(0,v.aH)(["currentFile","processedData","loading","error"]),cropGrowthData(){if(!this.processedData||!this.processedData.length)return{labels:[],datasets:[]};const e={};this.processedData.forEach((t=>{const a=t.Crop||"Unknown";e[a]||(e[a]={heights:[],widths:[]}),t["Height (cm)"]&&e[a].heights.push(parseFloat(t["Height (cm)"])),t["Width (cm)"]&&e[a].widths.push(parseFloat(t["Width (cm)"]))}));const t=Object.keys(e),a=[],s=[];return t.forEach((t=>{const r=e[t].heights,o=e[t].widths;a.push(r.length?r.reduce(((e,t)=>e+t),0)/r.length:0),s.push(o.length?o.reduce(((e,t)=>e+t),0)/o.length:0)})),{labels:t,datasets:[{label:"Average Height (cm)",data:a,backgroundColor:"rgba(75, 192, 192, 0.7)",borderColor:"rgb(75, 192, 192)",borderWidth:1},{label:"Average Width (cm)",data:s,backgroundColor:"rgba(54, 162, 235, 0.7)",borderColor:"rgb(54, 162, 235)",borderWidth:1}]}},healthIndicatorsData(){if(!this.processedData||!this.processedData.length)return{labels:[],datasets:[]};const e=[...this.processedData];e[0]["Measurement Date"]&&e.sort(((e,t)=>new Date(e["Measurement Date"])-new Date(t["Measurement Date"])));const t=15,a=Math.max(1,Math.floor(e.length/t)),s=e.filter(((e,t)=>t%a===0)),r=s.map((e=>e["Measurement Date"]||`Plot ${e["Plot ID"]||""}`)),o=s.map((e=>parseFloat(e["NDVI"]||0))),i=s.map((e=>parseFloat(e["Health Score"]||0))),l=s.map((e=>parseFloat(e["Chlorophyll Index"]||0)));return{labels:r,datasets:[{label:"NDVI",data:o,borderColor:"rgb(54, 162, 235)",backgroundColor:"rgba(54, 162, 235, 0.2)",borderWidth:2,tension:.2,fill:!0,yAxisID:"y"},{label:"Health Score",data:i,borderColor:"rgb(75, 192, 192)",backgroundColor:"rgba(75, 192, 192, 0.2)",borderWidth:2,tension:.2,fill:!0,yAxisID:"y1"},{label:"Chlorophyll Index",data:l,borderColor:"rgb(153, 102, 255)",backgroundColor:"rgba(153, 102, 255, 0.2)",borderWidth:2,tension:.2,fill:!0,yAxisID:"y2"}]}},cropDistributionData(){if(!this.processedData||!this.processedData.length)return{labels:[],datasets:[]};const e={};return this.processedData.forEach((t=>{const a=t.Crop||"Unknown";e[a]=(e[a]||0)+1})),{labels:Object.keys(e),datasets:[{data:Object.values(e),backgroundColor:["rgba(255, 99, 132, 0.7)","rgba(54, 162, 235, 0.7)","rgba(255, 206, 86, 0.7)","rgba(75, 192, 192, 0.7)","rgba(153, 102, 255, 0.7)","rgba(255, 159, 64, 0.7)"],borderColor:["rgb(255, 99, 132)","rgb(54, 162, 235)","rgb(255, 206, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(255, 159, 64)"],borderWidth:1}]}},growthStageData(){if(!this.processedData||!this.processedData.length)return{labels:[],datasets:[]};const e={};return this.processedData.forEach((t=>{const a=t["Growth Stage"]||"Unknown";e[a]=(e[a]||0)+1})),{labels:Object.keys(e),datasets:[{data:Object.values(e),backgroundColor:["rgba(75, 192, 192, 0.7)","rgba(153, 102, 255, 0.7)","rgba(255, 205, 86, 0.7)","rgba(54, 162, 235, 0.7)","rgba(255, 99, 132, 0.7)","rgba(201, 203, 207, 0.7)"],borderColor:["rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(255, 205, 86)","rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(201, 203, 207)"],borderWidth:1}]}},healthCategoriesData(){if(!this.processedData||!this.processedData.length)return{labels:[],datasets:[]};const e={"Excellent (90-100)":0,"Good (75-89)":0,"Fair (60-74)":0,"Poor (40-59)":0,"Critical (<40)":0};return this.processedData.forEach((t=>{const a=parseFloat(t["Health Score"]||0);a>=90?e["Excellent (90-100)"]++:a>=75?e["Good (75-89)"]++:a>=60?e["Fair (60-74)"]++:a>=40?e["Poor (40-59)"]++:e["Critical (<40)"]++})),{labels:Object.keys(e),datasets:[{data:Object.values(e),backgroundColor:["rgba(75, 192, 192, 0.7)","rgba(54, 162, 235, 0.7)","rgba(255, 205, 86, 0.7)","rgba(255, 159, 64, 0.7)","rgba(255, 99, 132, 0.7)"],borderColor:["rgb(75, 192, 192)","rgb(54, 162, 235)","rgb(255, 205, 86)","rgb(255, 159, 64)","rgb(255, 99, 132)"],borderWidth:1}]}},leafHealthData(){if(!this.processedData||!this.processedData.length)return{labels:[],datasets:[]};const e=this.processedData.filter((e=>e["Leaf Count"]&&e["Health Score"])).map((e=>({x:parseFloat(e["Leaf Count"]),y:parseFloat(e["Health Score"])})));return{labels:[],datasets:[{label:"Leaf Count vs Health Score",data:e,backgroundColor:"rgba(75, 192, 192, 0.7)",borderColor:"rgb(75, 192, 192)",pointRadius:5,pointHoverRadius:8}]}}},mounted(){this.fetchFileData(),this.startDataPolling()},beforeUnmount(){this.stopDataPolling()},methods:{...(0,v.i0)(["fetchFile","fetchProcessedData","processFile","deleteFile"]),async fetchFileData(){const e=this.$route.params.id;if(!e||"undefined"===e||"null"===e)return console.error("Invalid file ID:",e),this.$toast.error("Invalid file ID"),void this.$router.push("/files");console.log("Fetching file data for ID:",e);try{if(this.$store.commit("setLoading",!0),await this.$store.dispatch("fetchFile",e),this.currentFile&&this.currentFile.processed)try{await this.$store.dispatch("fetchProcessedData",e),this.processedData&&this.processedData.length>0&&setTimeout((()=>{this.generateDummyCharts()}),200)}catch(t){console.error("Error fetching processed data:",t),this.$toast.error("Could not load processed data")}}catch(a){console.error("Error fetching file data:",a),this.$toast.error(`Error loading file: ${a.response?.data?.error||a.message||"Unknown error"}`)}finally{this.$store.commit("setLoading",!1)}},startDataPolling(){const e=this.$route.params.id;if(e&&!this.pollingInterval){let e=0;this.pollingInterval=setInterval((()=>{e>=5||this.currentFile&&this.processedData&&this.processedData.length>0?this.stopDataPolling():(console.log("Polling for data, attempt:",e+1),this.fetchFileData(),e++)}),2e3)}},stopDataPolling(){this.pollingInterval&&(clearInterval(this.pollingInterval),this.pollingInterval=null)},refreshData(){this.fetchFileData()},async processFile(e){if(e||(e=this.currentFile?.id),e)try{this.$store.commit("setLoading",!0),this.$toast?.info("Processing file, please wait...");const a=await this.$store.dispatch("processFile",e);this.$toast?.success("File processed successfully"),await this.$nextTick();try{await this.$store.dispatch("fetchFile",e),this.currentFile&&this.currentFile.processed?setTimeout((async()=>{try{await this.$store.dispatch("fetchProcessedData",e),this.processedData&&this.processedData.length>0?this.generateDummyCharts():console.warn("No processed data available for charts")}catch(t){console.error("Error fetching processed data:",t),this.$toast?.error("Could not load processed data. Please try again.")}finally{this.$store.commit("setLoading",!1)}}),1e3):(this.$store.commit("setLoading",!1),console.warn("File is not marked as processed"))}catch(t){this.$store.commit("setLoading",!1),console.error("Error fetching updated file data:",t),this.$toast?.error("Error refreshing file data")}return a}catch(a){this.$store.commit("setLoading",!1),this.$toast?.error(`Error processing file: ${a.response?.data?.error||a.message||"Unknown error"}`),console.error("Error processing file:",a)}finally{setTimeout((()=>{this.showProcessingMessage=!1,this.processingFile=!1}),1500)}else this.$toast?.error("No file selected for processing")},formatDate(e){if(!e)return"N/A";const t=new Date(e);return t.toLocaleDateString()+" "+t.toLocaleTimeString()},formatFileSize(e){if(!e||0===e)return"Empty file (0 Bytes)";const t=["Bytes","KB","MB","GB","TB"],a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(2))+" "+t[a]},formatColumnName(e){return e?e.replace(/_/g," ").replace(/([A-Z])/g," $1").replace(/^./,(e=>e.toUpperCase())).trim():""},getFileExtension(e){if(!e)return"";const t=e.split(".");return t[t.length-1].toUpperCase()},exportCSV(){if(!this.processedData||0===this.processedData.length)return void this.$toast.error("No data to export");const e=this.processedData.reduce(((e,t)=>(Object.keys(t).forEach((t=>{e.includes(t)||e.push(t)})),e)),[]);let t=e.map((e=>`"${this.formatColumnName(e)}"`)).join(",")+"\n";this.processedData.forEach((a=>{const s=e.map((e=>{const t=void 0!==a[e]?a[e]:"";return`"${t}"`})).join(",");t+=s+"\n"}));const a=new Blob([t],{type:"text/csv;charset=utf-8;"}),s=URL.createObjectURL(a),r=document.createElement("a");r.setAttribute("href",s),r.setAttribute("download",`${this.currentFile?.title||"data"}_export.csv`),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)},generateDummyCharts(){Promise.resolve().then(a.bind(a,468)).then((e=>{this.$nextTick((()=>{try{const t=e.Chart||e.default||e;if(this.$refs.barChart){this.barChartInstance&&"function"===typeof this.barChartInstance.destroy&&this.barChartInstance.destroy();const e=[],a=[];if(this.processedData&&this.processedData.length>0){const t=this.processedData.slice(0,5),s=Object.keys(t[0]).slice(0,5);t.forEach((t=>{e.push(t[s[0]])})),t.forEach((e=>{const t=e[s[1]];a.push(isNaN(t)?Math.floor(100*Math.random()):parseFloat(t))}))}else e.push("Sample 1","Sample 2","Sample 3","Sample 4","Sample 5"),a.push(65,59,80,81,56);const s=this.$refs.barChart;if(!s||0===s.offsetWidth||0===s.offsetHeight)return void console.warn("Bar chart canvas not properly initialized");const r=s.getContext("2d");if(!r)return void console.warn("Failed to get 2D context from bar chart canvas");this.barChartInstance=new t(r,{type:"bar",data:{labels:e,datasets:[{label:"Sample Data",data:a,backgroundColor:"#198754",borderColor:"#157347",borderWidth:1}]},options:this.barChartOptions})}if(this.$refs.pieChart){this.pieChartInstance&&"function"===typeof this.pieChartInstance.destroy&&this.pieChartInstance.destroy();const e=this.$refs.pieChart;if(!e||0===e.offsetWidth||0===e.offsetHeight)return void console.warn("Pie chart canvas not properly initialized");const a=e.getContext("2d");if(!a)return void console.warn("Failed to get 2D context from pie chart canvas");let s=[],r=[];if(this.processedData&&this.processedData.length>0){const e=Object.keys(this.processedData[0]);if(e.length>=3){const t=e[2],a={};this.processedData.forEach((e=>{const s=e[t]||"Unknown";a[s]=(a[s]||0)+1})),s=Object.keys(a),r=Object.values(a)}else s=["Category A","Category B","Category C"],r=[300,50,100]}else s=["Red","Blue","Yellow","Green","Purple"],r=[12,19,3,5,2];const o=s.map((()=>`rgba(${Math.floor(255*Math.random())}, ${Math.floor(255*Math.random())}, ${Math.floor(255*Math.random())}, 0.7)`));this.pieChartInstance=new t(a,{type:"pie",data:{labels:s,datasets:[{data:r,backgroundColor:o,borderWidth:1}]},options:this.pieChartOptions})}}catch(t){console.error("Error creating charts:",t)}}))})).catch((e=>{console.error("Failed to load Chart.js:",e)}))},confirmDeleteFile(){confirm(`Are you sure you want to delete the file "${this.currentFile.title}"?`)&&this.deleteFile()},async deleteFile(){try{await this.$store.dispatch("deleteFile",this.currentFile.id),this.$toast?.success("File deleted successfully"),this.$router.push("/files")}catch(e){this.$toast?.error(`Error deleting file: ${e.response?.data?.error||"Unknown error"}`),console.error("Error deleting file:",e)}}}},_a=(0,_.A)(Fa,[["render",St]]),Ea=_a,Aa={class:"login-container"},xa={class:"card login-card"},Da={class:"card-body"},$a={key:0,class:"alert alert-danger"},Ia={class:"form-group mb-3"},Ta={class:"form-group mb-3"},Sa=["disabled"],Pa={key:0,class:"spinner-border spinner-border-sm mr-2"},Wa={class:"mt-3 text-center"};function Xa(e,t,a,i,l,n){const c=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)("div",Aa,[(0,r.Lk)("div",xa,[(0,r.Lk)("div",Da,[t[7]||(t[7]=(0,r.Lk)("h2",{class:"text-center mb-4"},[(0,r.Lk)("span",{class:"brand-name"},[(0,r.eW)("Aqua"),(0,r.Lk)("span",{class:"text-success"},"Green")])],-1)),l.error?((0,r.uX)(),(0,r.CE)("div",$a,(0,o.v_)(l.error),1)):(0,r.Q3)("",!0),(0,r.Lk)("form",{onSubmit:t[2]||(t[2]=(0,s.D$)(((...e)=>n.login&&n.login(...e)),["prevent"]))},[(0,r.Lk)("div",Ia,[(0,r.bo)((0,r.Lk)("input",{type:"text",class:"form-control","onUpdate:modelValue":t[0]||(t[0]=e=>l.username=e),placeholder:"Username",required:""},null,512),[[s.Jo,l.username]])]),(0,r.Lk)("div",Ta,[(0,r.bo)((0,r.Lk)("input",{type:"password",class:"form-control","onUpdate:modelValue":t[1]||(t[1]=e=>l.password=e),placeholder:"Password",required:""},null,512),[[s.Jo,l.password]])]),(0,r.Lk)("button",{type:"submit",class:"btn btn-success w-100 mt-3",disabled:l.loading},[l.loading?((0,r.uX)(),(0,r.CE)("span",Pa)):(0,r.Q3)("",!0),t[3]||(t[3]=(0,r.eW)(" Login "))],8,Sa)],32),(0,r.Lk)("div",Wa,[(0,r.Lk)("p",null,[t[5]||(t[5]=(0,r.eW)("Don't have an account? ")),(0,r.bF)(c,{to:"/register",class:"text-success"},{default:(0,r.k6)((()=>t[4]||(t[4]=[(0,r.eW)("Sign up")]))),_:1})]),(0,r.Lk)("p",null,[(0,r.bF)(c,{to:"/forgot-password",class:"text-secondary"},{default:(0,r.k6)((()=>t[6]||(t[6]=[(0,r.eW)("Forgot your password?")]))),_:1})])])])])])}const Ua={name:"LoginView",data(){return{username:"",password:"",loading:!1,error:null}},methods:{...(0,v.i0)(["loginUser"]),async login(){this.loading=!0,this.error=null;try{await this.loginUser({username:this.username,password:this.password}),this.$router.push("/")}catch(e){this.error=e.response?.data?.detail||"Login failed. Please check your credentials."}finally{this.loading=!1}}}},Ba=(0,_.A)(Ua,[["render",Xa],["__scopeId","data-v-7dceedfc"]]),Oa=Ba,ja={class:"register-container"},za={class:"card-body"},Ma={key:0,class:"alert alert-danger"},Na={class:"form-group mb-3"},Va={class:"form-group mb-3"},qa={class:"form-group mb-3"},Ga={class:"form-group mb-3"},Ha={class:"form-group mb-3"},Ra={class:"mt-3 text-center"};function Qa(e,t,a,i,l,n){const c=(0,r.g2)("BaseButton"),d=(0,r.g2)("router-link"),u=(0,r.g2)("BaseCard");return(0,r.uX)(),(0,r.CE)("div",ja,[(0,r.bF)(u,{class:"register-card"},{default:(0,r.k6)((()=>[(0,r.Lk)("div",za,[t[9]||(t[9]=(0,r.Lk)("h2",{class:"text-center mb-4"},[(0,r.Lk)("span",{class:"brand-name"},[(0,r.eW)("Aqua"),(0,r.Lk)("span",{class:"text-success"},"Green")])],-1)),e.error?((0,r.uX)(),(0,r.CE)("div",Ma,(0,o.v_)(e.error),1)):(0,r.Q3)("",!0),(0,r.Lk)("form",{onSubmit:t[5]||(t[5]=(0,s.D$)(((...t)=>e.register&&e.register(...t)),["prevent"]))},[(0,r.Lk)("div",Na,[(0,r.bo)((0,r.Lk)("input",{type:"email",class:"form-control","onUpdate:modelValue":t[0]||(t[0]=t=>e.email=t),placeholder:"Email"},null,512),[[s.Jo,e.email]])]),(0,r.Lk)("div",Va,[(0,r.bo)((0,r.Lk)("input",{type:"text",class:"form-control","onUpdate:modelValue":t[1]||(t[1]=t=>e.phone=t),placeholder:"Phone"},null,512),[[s.Jo,e.phone]])]),(0,r.Lk)("div",qa,[(0,r.bo)((0,r.Lk)("input",{type:"text",class:"form-control","onUpdate:modelValue":t[2]||(t[2]=t=>e.username=t),placeholder:"Username",required:""},null,512),[[s.Jo,e.username]])]),(0,r.Lk)("div",Ga,[(0,r.bo)((0,r.Lk)("input",{type:"password",class:"form-control","onUpdate:modelValue":t[3]||(t[3]=t=>e.password=t),placeholder:"Password",required:""},null,512),[[s.Jo,e.password]])]),(0,r.Lk)("div",Ha,[(0,r.bo)((0,r.Lk)("input",{type:"password",class:"form-control","onUpdate:modelValue":t[4]||(t[4]=t=>e.confirmPassword=t),placeholder:"Confirm Password",required:""},null,512),[[s.Jo,e.confirmPassword]])]),(0,r.bF)(c,{variant:"success",block:"",loading:e.loading,type:"submit"},{default:(0,r.k6)((()=>t[6]||(t[6]=[(0,r.eW)(" Sign up ")]))),_:1},8,["loading"])],32),(0,r.Lk)("div",Ra,[(0,r.Lk)("p",null,[t[8]||(t[8]=(0,r.eW)("Already have an account? ")),(0,r.bF)(d,{to:"/login",class:"text-success"},{default:(0,r.k6)((()=>t[7]||(t[7]=[(0,r.eW)("Log In")]))),_:1})])])])])),_:1})])}const Ja=(0,r.pM)({name:"RegisterView",components:{BaseButton:se.A,BaseCard:re.A},data(){return{email:"",phone:"",username:"",password:"",confirmPassword:"",loading:!1,error:null}},methods:{...(0,v.i0)(["registerUser"]),async register(){if(this.loading=!0,this.error=null,this.password!==this.confirmPassword)return this.error="Passwords do not match",void(this.loading=!1);if(!this.email)return this.error="Email is required for account verification",void(this.loading=!1);const e={username:this.username,email:this.email,password:this.password};this.phone&&(e.phone=this.phone);try{const t=await this.registerUser(e);t&&t.requires_verification?this.$router.push({name:"verify-otp",query:{email:this.email,returnPath:"/",isRegistration:"true"}}):this.$router.push("/")}catch(t){console.error("Registration error:",t),t.response&&(console.log("Error response data:",t.response.data),console.log("Error response status:",t.response.status),console.log("Error response headers:",t.response.headers));let e="Registration failed. Please try again.";if(t&&t.response&&t.response.data){const a=t.response.data;if(console.log("Error data type:",typeof a),a.errors)if("string"===typeof a.errors)e=a.errors;else{const t=[];for(const e in a.errors){const s=Array.isArray(a.errors[e])?a.errors[e].join(", "):a.errors[e];t.push(`${e}: ${s}`)}e=t.join("\n")}else if("string"===typeof a)e=a;else if("object"===typeof a){const t=[];for(const e in a){const s=Array.isArray(a[e])?a[e].join(", "):a[e];t.push(`${e}: ${s}`)}e=t.join("\n")}}this.error=e}finally{this.loading=!1}}}}),Ka=(0,_.A)(Ja,[["render",Qa],["__scopeId","data-v-2035ae01"]]),Za=Ka;var Ya=a(335);const es="http://127.0.0.1:8000/api",ts={namespaced:!0,state:{csvFiles:[],currentCsvFile:null,csvColumns:[],csvColumnTypes:{},csvData:[],cropImages:[],currentCropImage:null,metadata:[],metadataLabels:[],loading:!1,error:null},getters:{getCsvFiles:e=>e.csvFiles,getCurrentCsvFile:e=>e.currentCsvFile,getCsvColumns:e=>e.csvColumns,getCsvColumnTypes:e=>e.csvColumnTypes,getCsvData:e=>e.csvData,getCropImages:e=>e.cropImages,getCurrentCropImage:e=>e.currentCropImage,getMetadata:e=>e.metadata,getMetadataLabels:e=>e.metadataLabels,isLoading:e=>e.loading,getError:e=>e.error},mutations:{setCsvFiles(e,t){e.csvFiles=t},removeCsvFile(e,t){e.csvFiles=e.csvFiles.filter((e=>e.id!==t))},setCurrentCsvFile(e,t){e.currentCsvFile=t},setCsvColumns(e,t){e.csvColumns=t},setCsvColumnTypes(e,t){e.csvColumnTypes=t},setCsvData(e,t){e.csvData=t},setCropImages(e,t){e.cropImages=t},setCurrentCropImage(e,t){e.currentCropImage=t},setMetadata(e,t){e.metadata=t},setMetadataLabels(e,t){e.metadataLabels=t},setLoading(e,t){e.loading=t},setError(e,t){e.error=t},addCsvFile(e,t){e.csvFiles.unshift(t)},addCropImage(e,t){e.cropImages.unshift(t)},updateCropImage(e,t){const a=e.cropImages.findIndex((e=>e.id===t.id));-1!==a&&e.cropImages.splice(a,1,t)}},actions:{fetchCsvFiles({commit:e,rootGetters:t}){e("setLoading",!0),e("setError",null);const a=t.isAuthenticated?{Authorization:`Bearer ${t.getAuthToken}`}:{};return Ya.A.get(`${es}/csv-files/`,{headers:a}).then((t=>(e("setCsvFiles",t.data),t.data))).catch((t=>{throw e("setError",t.response?.data||"Failed to fetch CSV files"),t})).finally((()=>{e("setLoading",!1)}))},fetchCsvFile({commit:e,rootGetters:t},a){e("setLoading",!0),e("setError",null);const s=t.isAuthenticated?{Authorization:`Bearer ${t.getAuthToken}`}:{};return Ya.A.get(`${es}/csv-files/${a}/`,{headers:s}).then((t=>(e("setCurrentCsvFile",t.data),t.data))).catch((t=>{throw e("setError",t.response?.data||"Failed to fetch CSV file"),t})).finally((()=>{e("setLoading",!1)}))},uploadCsvFile({commit:e,rootGetters:t},a){e("setLoading",!0),e("setError",null);const s={"Content-Type":"multipart/form-data",...t.isAuthenticated?{Authorization:`Bearer ${t.getAuthToken}`}:{}};return Ya.A.post(`${es}/csv-files/`,a,{headers:s}).then((t=>(e("addCsvFile",t.data),t.data))).catch((t=>{throw e("setError",t.response?.data||"Failed to upload CSV file"),t})).finally((()=>{e("setLoading",!1)}))},processCsvFile({commit:e},t){return e("setLoading",!0),Ya.A.post(`${es}/csv-files/${t}/process/`).then((t=>(e("setLoading",!1),t.data))).catch((t=>{throw e("setLoading",!1),e("setError",t.response?.data||t.message),t}))},deleteCsvFile({commit:e},t){return e("setLoading",!0),Ya.A.delete(`${es}/csv-files/${t}/`).then((a=>(e("removeCsvFile",t),e("setLoading",!1),{success:!0,data:a.data}))).catch((t=>{e("setLoading",!1);const a=t.response?.data?.error||t.response?.data?.detail||t.message||"An error occurred while deleting the file";return e("setError",a),{success:!1,error:a,linkedToImages:a.includes("linked to")}}))},fetchCropImages({commit:e,rootGetters:t},a={}){e("setLoading",!0),e("setError",null);const s=t.isAuthenticated?{Authorization:`Bearer ${t.getAuthToken}`}:{},r={};return a.csvFile&&(r.csv_file=a.csvFile),a.sampleId&&(r.sample_id=a.sampleId),a.metadataLabel&&(r.metadata_label=a.metadataLabel),a.metadataValue&&(r.metadata_value=a.metadataValue),Ya.A.get(`${es}/crop-images/`,{headers:s,params:r}).then((t=>(e("setCropImages",t.data),t.data))).catch((t=>{throw e("setError",t.response?.data||"Failed to fetch crop images"),t})).finally((()=>{e("setLoading",!1)}))},fetchCropImage({commit:e,rootGetters:t},a){e("setLoading",!0),e("setError",null);const s=t.isAuthenticated?{Authorization:`Bearer ${t.getAuthToken}`}:{};return Ya.A.get(`${es}/crop-images/${a}/`,{headers:s}).then((t=>(e("setCurrentCropImage",t.data),t.data))).catch((t=>{throw e("setError",t.response?.data||"Failed to fetch crop image"),t})).finally((()=>{e("setLoading",!1)}))},uploadCropImages({commit:e,rootGetters:t},a){e("setLoading",!0),e("setError",null);const s={...t.isAuthenticated?{Authorization:`Bearer ${t.getAuthToken}`}:{}};return Ya.A.post(`${es}/crop-images/upload_images/`,a,{headers:s}).then((t=>(t.data.images&&Array.isArray(t.data.images)&&t.data.images.forEach((t=>{e("addCropImage",t)})),t.data))).catch((t=>{throw e("setError",t.response?.data?.error||"Failed to upload images"),t})).finally((()=>{e("setLoading",!1)}))},fetchMetadataLabels({commit:e,rootGetters:t}){e("setLoading",!0);const a=t.isAuthenticated?{Authorization:`Bearer ${t.getAuthToken}`}:{};return Ya.A.get(`${es}/crop-images/metadata_labels/`,{headers:a}).then((t=>(e("setMetadataLabels",t.data),t.data))).catch((e=>(console.error("Failed to fetch metadata labels:",e),[]))).finally((()=>{e("setLoading",!1)}))},addMetadataToImage({commit:e,rootGetters:t},{imageId:a,metadata:s}){e("setLoading",!0),e("setError",null);const r=t.isAuthenticated?{Authorization:`Bearer ${t.getAuthToken}`}:{};return Ya.A.post(`${es}/crop-images/${a}/add_metadata/`,{metadata:s},{headers:r}).then((e=>e.data.metadata&&Array.isArray(e.data.metadata)?this.dispatch("crop/fetchCropImage",a):e.data)).catch((t=>{throw e("setError",t.response?.data||"Failed to add metadata"),t})).finally((()=>{e("setLoading",!1)}))},fetchCsvFilePreview({commit:e,rootGetters:t},a){e("setLoading",!0),e("setError",null);const s=t.isAuthenticated?{Authorization:`Bearer ${t.getAuthToken}`}:{};return Ya.A.get(`${es}/csv-files/${a}/preview/`,{headers:s}).then((t=>{const{columns:a,column_types:s}=t.data;return e("setCsvColumns",a),e("setCsvColumnTypes",s),t.data})).catch((t=>{throw e("setError",t.response?.data||"Failed to fetch CSV preview"),t})).finally((()=>{e("setLoading",!1)}))},fetchCsvData({commit:e,rootGetters:t},{fileId:a,selectedColumns:s=[]}){e("setLoading",!0),e("setError",null);const r=t.isAuthenticated?{Authorization:`Bearer ${t.getAuthToken}`}:{};let o={file_id:a};return s&&s.length>0&&(o["columns[]"]=s),Ya.A.get(`${es}/csv-data/`,{headers:r,params:o}).then((t=>(e("setCsvColumns",t.data.columns),e("setCsvData",t.data.rows),e("setCsvColumnTypes",t.data.column_types),t.data))).catch((t=>{throw e("setError",t.response?.data||"Failed to fetch CSV data"),t})).finally((()=>{e("setLoading",!1)}))}}},as=ts,ss="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?"http://127.0.0.1:8000/api":`http://${window.location.hostname}:8000/api`,rs=(0,v.y$)({modules:{crop:as},state:{files:[],currentFile:null,processedData:[],loading:!1,error:null,token:localStorage.getItem("token")||null,refreshToken:localStorage.getItem("refreshToken")||null,user:JSON.parse(localStorage.getItem("user"))||null,isAuthenticated:!!localStorage.getItem("token")},getters:{isAuthenticated:e=>e.isAuthenticated,currentUser:e=>e.user,getAuthToken:e=>e.token,getFiles:e=>e.files,getCurrentFile:e=>e.currentFile,getProcessedData:e=>e.processedData,isLoading:e=>e.loading,getError:e=>e.error},mutations:{setFiles(e,t){e.files=t},setCurrentFile(e,t){e.currentFile=t},setProcessedData(e,t){e.processedData=t},setLoading(e,t){e.loading=t},setError(e,t){e.error=t},setAuth(e,{token:t,refreshToken:a,user:s}){e.token=t,e.refreshToken=a,e.user=s,e.isAuthenticated=!0,localStorage.setItem("token",t),localStorage.setItem("refreshToken",a),localStorage.setItem("user",JSON.stringify(s))},clearAuth(e){e.token=null,e.refreshToken=null,e.user=null,e.isAuthenticated=!1,localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user")},removeFile(e,t){e.files=e.files.filter((e=>e.id!==t))}},actions:{registerUser({commit:e},t){return e("setLoading",!0),e("setError",null),console.log("Registration request payload:",t),console.log("Registration endpoint:",`${ss}/auth/register/`),Ya.A.post(`${ss}/auth/register/`,t).then((t=>{if(console.log("Registration success response:",t.data),t.data&&t.data.success){if(t.data.requires_verification)return t.data;{const{access:a,refresh:s,user:r}=t.data;return e("setAuth",{token:a,refreshToken:s,user:r}),t.data}}throw e("setError",t.data.errors||"Registration failed"),{response:t}})).catch((t=>{throw t.response&&t.response.data&&t.response.data.errors?e("setError",t.response.data.errors):e("setError",t.response?.data||"Registration failed"),t})).finally((()=>{e("setLoading",!1)}))},loginUser({commit:e},t){return e("setLoading",!0),e("setError",null),Ya.A.post(`${ss}/auth/login/`,t).then((t=>{const{access:a,refresh:s,user:r}=t.data;return e("setAuth",{token:a,refreshToken:s,user:r}),t})).catch((t=>{throw e("setError",t.response?.data||"Login failed"),t})).finally((()=>{e("setLoading",!1)}))},refreshToken({commit:e,state:t}){return t.refreshToken?Ya.A.post(`${ss}/auth/token/refresh/`,{refresh:t.refreshToken}).then((a=>{const{access:s}=a.data;return e("setAuth",{token:s,refreshToken:t.refreshToken,user:t.user}),a})).catch((t=>{throw e("clearAuth"),t})):Promise.reject(new Error("No refresh token available"))},logout({commit:e}){return e("clearAuth"),Promise.resolve()},fetchFiles({commit:e,getters:t}){e("setLoading",!0),e("setError",null),console.log("Fetching files with auth token:",t.isAuthenticated?"Token exists":"No token");const a=t.isAuthenticated?{Authorization:`Bearer ${t.getAuthToken}`}:{};return Ya.A.get(`${ss}/excel-files/`,{headers:a}).then((t=>(console.log("Files API response:",t),Array.isArray(t.data)?(console.log(`Received ${t.data.length} files from API`),e("setFiles",t.data),t.data):(console.warn("API response is not an array:",t.data),t.data&&Array.isArray(t.data.results)?(console.log(`Using results array with ${t.data.results.length} files`),e("setFiles",t.data.results),t.data.results):(console.error("Could not extract files array from response"),e("setFiles",[]),[]))))).catch((t=>{throw console.error("Error fetching files:",t.response?.data||t),e("setError",t.response?.data||"Failed to fetch files"),t})).finally((()=>{e("setLoading",!1)}))},fetchFile({commit:e,getters:t},a){e("setLoading",!0),e("setError",null);const s=t.isAuthenticated?{Authorization:`Bearer ${t.getAuthToken}`}:{};return Ya.A.get(`${ss}/excel-files/${a}/detail/`,{headers:s}).then((t=>(e("setCurrentFile",t.data),t.data))).catch((t=>(console.warn("Detail endpoint failed, trying standard endpoint:",t.message),Ya.A.get(`${ss}/excel-files/${a}/`,{headers:s}).then((t=>(e("setCurrentFile",t.data),t.data))).catch((t=>{throw console.error("Error fetching file details:",t.response?.data||t),e("setError",t.response?.data?.error||"Failed to fetch file details"),t}))))).finally((()=>{e("setLoading",!1)}))},uploadFile({commit:e,getters:t,dispatch:a},s){e("setLoading",!0),e("setError",null);const r={...t.isAuthenticated?{Authorization:`Bearer ${t.getAuthToken}`}:{}};return Ya.A.post(`${ss}/excel-files/`,s,{headers:r}).then((e=>(console.log("File upload response:",e.data),a("fetchFiles"),{...e.data,uploadSuccess:!0}))).catch((t=>{throw console.error("Error uploading file:",t.response?.data||t),e("setError",t.response?.data?.error||"Failed to upload file"),t})).finally((()=>{e("setLoading",!1)}))},processFile({commit:e,getters:t},a){if(e("setLoading",!0),e("setError",null),!a||"undefined"===a||"null"===a)return console.error("Invalid file ID for processing:",a),e("setError","Invalid file ID"),e("setLoading",!1),Promise.reject(new Error("Invalid file ID"));const s=t.isAuthenticated?{Authorization:`Bearer ${t.getAuthToken}`}:{},r={headers:s,timeout:6e4};return Ya.A.post(`${ss}/excel-files/${a}/process/`,{},r).then((e=>(console.log("File processing response:",e.data),e.data))).catch((t=>{let a=t.response?.data?.error||t.response?.data||t.message||"Failed to process file";throw"object"===typeof a&&(a=JSON.stringify(a)),console.error("Error processing file:",a),e("setError",a),t})).finally((()=>{e("setLoading",!1)}))},fetchProcessedData({commit:e,getters:t},a){if(e("setLoading",!0),e("setError",null),!a||"undefined"===a||"null"===a)return console.error("Invalid file ID for processed data:",a),e("setProcessedData",[]),e("setLoading",!1),Promise.resolve([]);console.log("Fetching processed data for file ID:",a);const s=t.isAuthenticated?{Authorization:`Bearer ${t.getAuthToken}`}:{},r={headers:s,timeout:3e4},o=(t=1,s=3)=>Ya.A.get(`${ss}/processed-data/by_file/?file_id=${a}`,r).then((t=>(console.log("Processed data response:",t),t.data&&t.data.success&&t.data.data?(e("setProcessedData",t.data.data),t.data.data):Array.isArray(t.data)?(e("setProcessedData",t.data),t.data):(console.warn("Unexpected processed data format:",t.data),e("setProcessedData",[]),[])))).catch((a=>{if(t<s&&("ECONNABORTED"===a.code||a.response?.status>=500)){console.warn(`Retrying processed data fetch (attempt ${t+1}/${s})...`);const e=Math.min(1e3*Math.pow(2,t-1),8e3);return new Promise((a=>{setTimeout((()=>{a(o(t+1,s))}),e)}))}return console.error("Error fetching processed data:",a.response?.data||a),e("setError",a.response?.data?.error||a.response?.data||"Failed to fetch processed data"),e("setProcessedData",[]),[]}));return o().finally((()=>{e("setLoading",!1)}))},deleteFile({commit:e,getters:t},a){e("setLoading",!0),e("setError",null);const s=t.isAuthenticated?{Authorization:`Bearer ${t.getAuthToken}`}:{};return Ya.A.delete(`${ss}/excel-files/${a}/`,{headers:s}).then((s=>(e("removeFile",a),t.getCurrentFile&&t.getCurrentFile.id===a&&e("setCurrentFile",null),s.data))).catch((t=>{throw console.error("Error deleting file:",t.response?.data||t),e("setError",t.response?.data?.error||t.response?.data||"Failed to delete file"),t})).finally((()=>{e("setLoading",!1)}))},fetchUserProfile({commit:e,getters:t}){e("setLoading",!0),e("setError",null);const a=t.isAuthenticated?{Authorization:`Bearer ${t.getAuthToken}`}:{};return Ya.A.get(`${ss}/auth/profile/`,{headers:a}).then((e=>e.data)).catch((t=>(console.error("Error fetching user profile:",t.response?.data||t),e("setError",t.response?.data?.error||t.response?.data||"Failed to fetch user profile"),Promise.reject(t)))).finally((()=>{e("setLoading",!1)}))},updateProfileImage({commit:e,getters:t},a){e("setLoading",!0),e("setError",null);const s={Authorization:`Bearer ${t.getAuthToken}`,"Content-Type":"multipart/form-data"};return Ya.A.patch(`${ss}/auth/profile/`,a,{headers:s}).then((e=>e.data)).catch((t=>(console.error("Error updating profile image:",t.response?.data||t),e("setError",t.response?.data?.error||t.response?.data||"Failed to update profile image"),Promise.reject(t)))).finally((()=>{e("setLoading",!1)}))}}}),os=[{path:"/",name:"root",redirect:()=>localStorage.getItem("token")?"/dashboard":"/login"},{path:"/dashboard",name:"dashboard",component:N,meta:{requiresAuth:!0}},{path:"/upload",name:"upload",component:le,meta:{requiresAuth:!0}},{path:"/files",name:"files",component:Ae,meta:{requiresAuth:!0}},{path:"/files/:id",name:"file-detail",component:Ea,meta:{requiresAuth:!0}},{path:"/crop-images",name:"crop-images",component:()=>a.e(564).then(a.bind(a,564)),meta:{requiresAuth:!0}},{path:"/crop-images/:id",name:"crop-image-detail",component:()=>a.e(601).then(a.bind(a,601)),meta:{requiresAuth:!0}},{path:"/csv-files",name:"csv-files",component:()=>a.e(839).then(a.bind(a,839)),meta:{requiresAuth:!0}},{path:"/login",name:"login",component:Oa,meta:{guest:!0}},{path:"/register",name:"register",component:Za,meta:{guest:!0}},{path:"/signup",name:"signup",component:Za,meta:{guest:!0}},{path:"/forgot-password",name:"forgot-password",component:()=>a.e(678).then(a.bind(a,678)),meta:{guest:!0}},{path:"/reset-password/:uid/:token",name:"reset-password",component:()=>a.e(63).then(a.bind(a,63)),meta:{guest:!0}},{path:"/verify-reset-code",name:"verify-reset-code",component:()=>a.e(921).then(a.bind(a,921)),props:e=>({email:e.query.email}),meta:{guest:!0}},{path:"/verify-otp",name:"verify-otp",component:()=>a.e(485).then(a.bind(a,485)),props:e=>({email:e.query.email,returnPath:e.query.returnPath}),meta:{guest:!0}},{path:"/profile",name:"profile",component:()=>a.e(992).then(a.bind(a,992)),meta:{requiresAuth:!0}},{path:"/visualizations",name:"visualizations",component:()=>a.e(453).then(a.bind(a,453)),meta:{requiresAuth:!0}}],is=(0,x.aE)({history:(0,x.LA)("/"),routes:os});is.beforeEach(((e,t,a)=>{const s=rs.getters.isAuthenticated;"/"!==e.path?e.matched.some((e=>e.meta.requiresAuth))?s?a():a({name:"login"}):e.matched.some((e=>e.meta.guest))&&s?a({name:"dashboard"}):a():a(s?{name:"dashboard"}:{name:"login"})}));const ls=is;a(414);let ns;const cs=9e5,ds=()=>{clearTimeout(ns),ns=setTimeout((()=>{rs.getters.isAuthenticated&&(rs.commit("clearAuth"),ls.push("/login"))}),cs)};window.addEventListener("mousemove",ds),window.addEventListener("keypress",ds),window.addEventListener("click",ds),ds();const us=(0,s.Ef)(A).use(rs).use(ls);us.config.globalProperties.$toast={success(e){this._showToast(e,"success","bi-check-circle-fill")},error(e){this._showToast(e,"danger","bi-exclamation-triangle-fill")},warning(e){this._showToast(e,"warning","bi-exclamation-circle-fill")},info(e){this._showToast(e,"info","bi-info-circle-fill")},_showToast(e,t,a){const s=document.getElementById("toast-container")||this._createToastContainer(),r=document.createElement("div");r.className=`toast show toast-${t}`,r.setAttribute("role","alert"),r.setAttribute("aria-live","assertive"),r.setAttribute("aria-atomic","true"),r.innerHTML=`\n      <div class="toast-header bg-${t} text-white">\n        <i class="bi ${a} me-2"></i>\n        <strong class="me-auto">${t.charAt(0).toUpperCase()+t.slice(1)}</strong>\n        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast" aria-label="Close"></button>\n      </div>\n      <div class="toast-body">\n        ${e}\n      </div>\n    `,s.appendChild(r),setTimeout((()=>{r.classList.add("fade-out"),setTimeout((()=>r.remove()),300)}),5e3);const o=r.querySelector(".btn-close");o&&o.addEventListener("click",(()=>{r.classList.add("fade-out"),setTimeout((()=>r.remove()),300)}))},_createToastContainer(){const e=document.createElement("div");e.id="toast-container",e.className="toast-container position-fixed top-0 end-0 p-3",e.style.zIndex="1080";const t=document.createElement("style");return t.textContent="\n      .toast { \n        opacity: 1; \n        transition: opacity 0.3s ease-out; \n        box-shadow: 0 4px 12px rgba(0,0,0,0.1);\n        margin-bottom: 10px;\n      }\n      .toast.fade-out { \n        opacity: 0; \n      }\n      .toast-success { border-left: 4px solid #198754; }\n      .toast-danger { border-left: 4px solid #dc3545; }\n      .toast-warning { border-left: 4px solid #ffc107; }\n      .toast-info { border-left: 4px solid #0dcaf0; }\n    ",document.head.appendChild(t),document.body.appendChild(e),e}},Ya.A.defaults.baseURL="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?"http://127.0.0.1:8000/api":`http://${window.location.hostname}:8000/api`,Ya.A.interceptors.request.use((e=>(rs.getters.isAuthenticated&&(e.headers.Authorization=`Bearer ${rs.getters.getAuthToken}`),e)),(e=>Promise.reject(e))),Ya.A.interceptors.response.use((e=>e),(async e=>{const t=e.config;if(e.response&&401===e.response.status&&!t._retry){t._retry=!0;try{await rs.dispatch("refreshToken");const e=rs.getters.getAuthToken;return Ya.A.defaults.headers.common["Authorization"]=`Bearer ${e}`,t.headers["Authorization"]=`Bearer ${e}`,(0,Ya.A)(t)}catch(a){return us.config.globalProperties.$toast.error("Session expired. Please log in again."),rs.commit("clearAuth"),ls.push("/login"),Promise.reject(a)}}return Promise.reject(e)})),us.mount("#app")},753:(e,t,a)=>{a.d(t,{A:()=>u});var s=a(641),r=a(33);const o=["disabled","type"],i={key:0,class:"spinner-border spinner-border-sm me-2",role:"status"};function l(e,t,a,l,n,c){return(0,s.uX)(),(0,s.CE)("button",{class:(0,r.C4)(c.buttonClasses),disabled:a.disabled||a.loading,onClick:t[0]||(t[0]=t=>e.$emit("click",t)),type:a.type},[a.loading?((0,s.uX)(),(0,s.CE)("span",i)):(0,s.Q3)("",!0),(0,s.RG)(e.$slots,"default",{},(()=>[t[1]||(t[1]=(0,s.eW)("Button"))]),!0)],10,o)}const n={name:"BaseButton",props:{variant:{type:String,default:"primary",validator:e=>["primary","secondary","success","danger","warning","info","light","dark","outline-primary","outline-secondary","outline-success","outline-danger","outline-warning","outline-info","outline-light","outline-dark"].includes(e)},size:{type:String,default:"",validator:e=>["","sm","lg"].includes(e)},block:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},type:{type:String,default:"button",validator:e=>["button","submit","reset"].includes(e)}},computed:{buttonClasses(){return["btn",`btn-${this.variant}`,this.size?`btn-${this.size}`:"",this.block?"d-block w-100":""]}}};var c=a(262);const d=(0,c.A)(n,[["render",l],["__scopeId","data-v-59c7c2a7"]]),u=d}},t={};function a(s){var r=t[s];if(void 0!==r)return r.exports;var o=t[s]={exports:{}};return e[s].call(o.exports,o,o.exports,a),o.exports}a.m=e,(()=>{var e=[];a.O=(t,s,r,o)=>{if(!s){var i=1/0;for(d=0;d<e.length;d++){for(var[s,r,o]=e[d],l=!0,n=0;n<s.length;n++)(!1&o||i>=o)&&Object.keys(a.O).every((e=>a.O[e](s[n])))?s.splice(n--,1):(l=!1,o<i&&(i=o));if(l){e.splice(d--,1);var c=r();void 0!==c&&(t=c)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[s,r,o]}})(),(()=>{a.d=(e,t)=>{for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}})(),(()=>{a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce(((t,s)=>(a.f[s](e,t),t)),[]))})(),(()=>{a.u=e=>"js/"+e+"."+{63:"a22cb9f2",154:"ff13420f",453:"2b869633",485:"e4e69ad0",564:"1260349a",601:"e4353e50",678:"683ecf3a",839:"747ae53f",921:"80db9a08",992:"be124e5f"}[e]+".js"})(),(()=>{a.miniCssF=e=>"css/"+e+"."+{63:"deeb4d8a",453:"bdc65731",485:"43267a36",564:"49ad83df",601:"d0f74f1a",678:"d086d1b7",839:"a1d64dab",921:"7f0dcdde",992:"e0f17019"}[e]+".css"})(),(()=>{a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{var e={},t="data-processor-frontend:";a.l=(s,r,o,i)=>{if(e[s])e[s].push(r);else{var l,n;if(void 0!==o)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==s||u.getAttribute("data-webpack")==t+o){l=u;break}}l||(n=!0,l=document.createElement("script"),l.charset="utf-8",l.timeout=120,a.nc&&l.setAttribute("nonce",a.nc),l.setAttribute("data-webpack",t+o),l.src=s),e[s]=[r];var h=(t,a)=>{l.onerror=l.onload=null,clearTimeout(p);var r=e[s];if(delete e[s],l.parentNode&&l.parentNode.removeChild(l),r&&r.forEach((e=>e(a))),t)return t(a)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:l}),12e4);l.onerror=h.bind(null,l.onerror),l.onload=h.bind(null,l.onload),n&&document.head.appendChild(l)}}})(),(()=>{a.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{a.p="/"})(),(()=>{if("undefined"!==typeof document){var e=(e,t,s,r,o)=>{var i=document.createElement("link");i.rel="stylesheet",i.type="text/css",a.nc&&(i.nonce=a.nc);var l=a=>{if(i.onerror=i.onload=null,"load"===a.type)r();else{var s=a&&a.type,l=a&&a.target&&a.target.href||t,n=new Error("Loading CSS chunk "+e+" failed.\n("+s+": "+l+")");n.name="ChunkLoadError",n.code="CSS_CHUNK_LOAD_FAILED",n.type=s,n.request=l,i.parentNode&&i.parentNode.removeChild(i),o(n)}};return i.onerror=i.onload=l,i.href=t,s?s.parentNode.insertBefore(i,s.nextSibling):document.head.appendChild(i),i},t=(e,t)=>{for(var a=document.getElementsByTagName("link"),s=0;s<a.length;s++){var r=a[s],o=r.getAttribute("data-href")||r.getAttribute("href");if("stylesheet"===r.rel&&(o===e||o===t))return r}var i=document.getElementsByTagName("style");for(s=0;s<i.length;s++){r=i[s],o=r.getAttribute("data-href");if(o===e||o===t)return r}},s=s=>new Promise(((r,o)=>{var i=a.miniCssF(s),l=a.p+i;if(t(i,l))return r();e(s,l,null,r,o)})),r={524:0};a.f.miniCss=(e,t)=>{var a={63:1,453:1,485:1,564:1,601:1,678:1,839:1,921:1,992:1};r[e]?t.push(r[e]):0!==r[e]&&a[e]&&t.push(r[e]=s(e).then((()=>{r[e]=0}),(t=>{throw delete r[e],t})))}}})(),(()=>{var e={524:0};a.f.j=(t,s)=>{var r=a.o(e,t)?e[t]:void 0;if(0!==r)if(r)s.push(r[2]);else{var o=new Promise(((a,s)=>r=e[t]=[a,s]));s.push(r[2]=o);var i=a.p+a.u(t),l=new Error,n=s=>{if(a.o(e,t)&&(r=e[t],0!==r&&(e[t]=void 0),r)){var o=s&&("load"===s.type?"missing":s.type),i=s&&s.target&&s.target.src;l.message="Loading chunk "+t+" failed.\n("+o+": "+i+")",l.name="ChunkLoadError",l.type=o,l.request=i,r[1](l)}};a.l(i,n,"chunk-"+t,t)}},a.O.j=t=>0===e[t];var t=(t,s)=>{var r,o,[i,l,n]=s,c=0;if(i.some((t=>0!==e[t]))){for(r in l)a.o(l,r)&&(a.m[r]=l[r]);if(n)var d=n(a)}for(t&&t(s);c<i.length;c++)o=i[c],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(d)},s=self["webpackChunkdata_processor_frontend"]=self["webpackChunkdata_processor_frontend"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var s=a.O(void 0,[504],(()=>a(566)));s=a.O(s)})();
//# sourceMappingURL=app.bfed6c81.js.map